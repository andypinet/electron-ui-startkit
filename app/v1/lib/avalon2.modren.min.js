!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports["avalon"]=b():a["avalon"]=b()}(this,function(){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.m=a,c.c=b,c.p="",c(0)}([function(a,b,c){var d=c(83);c(8),c(15),c(85),c(94),c(71),c(103),c(104),a.exports=d},,,function(a,b){!function(b){function c(a){return new c.init(a)}var d,e;b.avalon=c,"undefined"!=typeof window&&(window.avalon=c),c.init=function(a){this[0]=this.element=a},c.fn=c.prototype=c.init.prototype,c.shadowCopy=function(a,b){for(var c in b)a[c]=b[c];return a},d=/[^, ]+/g,e=b.console,c.shadowCopy(c,{noop:function(){},rword:d,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){e&&c.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(e&&c.config.debug){var a=console.warn||console.log;Function.apply.call(a,console,arguments)}},error:function(a,b){throw(b||Error)(a)},oneObject:function(a,b){var c,e,f,g;for("string"==typeof a&&(a=a.match(d)||[]),c={},e=void 0!==b?b:1,f=0,g=a.length;g>f;f++)c[a[f]]=e;return c}}),a.exports=c}.call(b,function(){return this}())},function(a,b){!function(b){var e,c=b,d={window:c,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:0/0,modern:!0,avalonDiv:{},avalonFragment:null};c.location&&c.navigator&&c.window&&(e=c.document,d.document=e,d.modern=c.dispatchEvent,d.root=e.documentElement,d.avalonDiv=e.createElement("div"),d.avalonFragment=e.createDocumentFragment(),c.VBArray&&(d.msie=e.documentMode||(c.XMLHttpRequest?7:6))),a.exports=d}.call(b,function(){return this}())},,function(a){var i,c={},d=/([a-z\d])([A-Z]+)/g,e=/[-_][^-_]/g,f=/\d\.\d{4}/,g=/[-.*+?^${}()|[\]\/\\]/g,h=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},resolvedComponents:{},directives:{},eventHooks:{},eventListeners:{},validators:{},cssHooks:c,parsers:{number:function(a){return""===a?"":parseFloat(a)||0},string:function(a){return null===a||void 0===a?"":a+""},"boolean":function(a){return"true"===a}},version:"2.06",slice:function(a,b,c){return h.call(a,b,c)},css:function(a,b,d,e){var f,g;if(a instanceof avalon&&(a=a[0]),f=avalon.camelize(b),b=avalon.cssName(f)||f,void 0===d||"boolean"==typeof d)return e=c[f+":get"]||c["@:get"],"background"===b&&(b="backgroundColor"),g=e(a,b),d===!0?parseFloat(g)||0:g;if(""===d)a.style[b]="";else{if(null==d||d!==d)return;isFinite(d)&&!avalon.cssNumber[f]&&(d+="px"),e=c[f+":set"]||c["@:set"],e(a,b,d)}},directive:function(a,b){return this.directives[a]=b},isObject:function(a){return null!==a&&"object"==typeof a},range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},hyphen:function(a){return a.replace(d,"$1-$2").toLowerCase()},camelize:function(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(e,function(a){return a.charAt(1).toUpperCase()})},makeHashCode:function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(f,a)},escapeRegExp:function(a){return(a+"").replace(g,"\\$&")},Array:{merge:function(a,b){a.push.apply(a,b)},ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?avalon.Array.removeAt(a,c):!1}}}),i=1,a.exports={avalon:avalon,getLongID:function(a){return a.uuid||(a.uuid=avalon.makeHashCode("e"))},getShortID:function(a){return a.uuid||(a.uuid="_"+ ++i)}}},function(){function c(a){var b,d;for(b in a)avalon.ohasOwn.call(a,b)&&(d=a[b],"function"==typeof c.plugins[b]?c.plugins[b](d):"object"==typeof c[b]?avalon.shadowCopy(c[b],d):c[b]=d);return this}avalon.config=c;var d={interpolate:function(a){var e,f,g,h,b=a[0],d=a[1];if(b===d)throw new SyntaxError("openTag!==closeTag");if(e=b+"test"+d,f=avalon.avalonDiv,f.innerHTML=e,f.innerHTML!==e&&f.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");f.innerHTML="",c.openTag=b,c.closeTag=d,g=avalon.escapeRegExp(b),h=avalon.escapeRegExp(d),c.rexpr=new RegExp(g+"([\\ss\\S]*)"+h),c.rexprg=new RegExp(g+"([\\ss\\S]*)"+h,"g"),c.rbind=new RegExp(g+"[\\ss\\S]*"+h+"|\\bms-|\\bslot\\b")}};c.plugins=d,avalon.config({interpolate:["{{","}}"],debug:!0})},function(a,b,c){function k(a){return a}var d=c(9),e=c(10),f=c(11),g=c(12),h=c(13),i=c(14),j=avalon.filters;avalon.__format__=function(a){var b=j[a];return b?b.get?b.get:b:k},avalon.mix(j,{uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){return b=b||30,c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:String(a)},camelize:avalon.camelize,date:g,escape:e,sanitize:f,number:d,currency:function(a,b,c){return(b||"￥")+d(a,isFinite(c)?c:2)}},h,i),a.exports=avalon},function(a){function c(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}a.exports=c},function(a){function e(a){return String(a).replace(/&/g,"&amp;").replace(c,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(d,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d=/([^\#-~| |!])/g;a.exports=e},function(a){var c=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,d=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,e=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,f={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};a.exports=function(a){return a.replace(c,"").replace(e,function(a){var e,c=a.toLowerCase().match(/<(\w+)\s/);return c&&(e=f[c[1]],e&&(a=a.replace(e,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))),a.replace(d," ").replace(/\s+/g," ")})}},function(a){function c(a){return parseInt(a,10)||0}function d(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function e(a,b,c,e){return function(f){var g=f["get"+a]();return(c>0||g>-c)&&(g+=c),0===g&&-12===c&&(g=12),d(g,b,e)}}function f(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function g(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=d(Math[b>0?"floor":"ceil"](b/60),2)+d(Math.abs(b%60),2)}function h(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function l(a,b){var g,h,m,n,o,p,q,r,s,d=l.locate,e="",f=[];if(b=b||"mediumDate",b=d[b]||b,"string"==typeof a&&(/^\d+$/.test(a)?a=c(a):k.test(a)?a=+RegExp.$1:(m=a.trim(),n=[0,0,0,0,0,0,0],o=new Date(0),m=m.replace(/^(\d+)\D(\d+)\D(\d+)/,function(a,b,d,e){var f=4===e.length?[e,b,d]:[b,d,e];return n[0]=c(f[0]),n[1]=c(f[1])-1,n[2]=c(f[2]),""}),p=o.setFullYear,q=o.setHours,m=m.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(a,b,d,e,f){return n[3]=c(b),n[4]=c(d),n[5]=c(e),f&&(n[6]=Math.round(1e3*parseFloat("0."+f))),""}),r=0,s=0,m=m.replace(/Z|([+-])(\d\d):?(\d\d)/,function(a,b,d,e){return p=o.setUTCFullYear,q=o.setUTCHours,b&&(r=c(b+d),s=c(b+e)),""}),n[3]-=r,n[4]-=s,p.apply(o,n.slice(0,3)),q.apply(o,n.slice(3)),a=o)),"number"==typeof a&&(a=new Date(a)),"date"===avalon.type(a)){for(;b;)h=j.exec(b),h?(f=f.concat(h.slice(1)),b=f.pop()):(f.push(b),b=null);return f.forEach(function(b){g=i[b],e+=g?g(a,d):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),e}}var i={yyyy:e("FullYear",4),yy:e("FullYear",2,0,!0),y:e("FullYear",1),MMMM:f("Month"),MMM:f("Month",!0),MM:e("Month",2,1),M:e("Month",1,1),dd:e("Date",2),d:e("Date",1),HH:e("Hours",2),H:e("Hours",1),hh:e("Hours",2,-12),h:e("Hours",1,-12),mm:e("Minutes",2),m:e("Minutes",1),ss:e("Seconds",2),s:e("Seconds",1),sss:e("Milliseconds",3),EEEE:f("Day"),EEE:f("Day",!0),a:h,Z:g},j=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,k=/^\/Date\((\d+)\)\/$/,m={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};m.SHORTMONTH=m.MONTH,l.locate=m,a.exports=l},function(a){function c(a,b,c){var e,f,i,j,d=avalon.type(a);if("array"!==d&&"object"!==d)throw"orderBy只能处理对象或数组";return e=c&&0>c?-1:1,"string"==typeof b&&(f=b,b=function(a){return a&&a[f]}),a=h(a),a.forEach(function(a){a.order=b(a.value,a.key)}),a.sort(function(a,b){var c=a.order,d=b.order;return Number.isNaN(c)&&Number.isNaN(d)?0:c===d?0:c>d?e:-e}),i="array"===d,j=i?[]:{},g(j,a,function(a){i?j.push(a.value):j[a.key]=a.value})}function d(a,b){var d,e,f,i,j,k,c=avalon.type(a);if("array"!==c&&"object"!==c)throw"filterBy只能处理对象或数组";if(d=avalon.slice(arguments,2),e=avalon.type(b),"function"===e)f=b;else{if("string"!==e&&"number"!==e)return a;if(""===b)return a;i=new RegExp(avalon.escapeRegExp(b),"i"),f=function(a){return i.test(a)}}return a=h(a).filter(function(a,b){return!!f.apply(a,[a.value,b].concat(d))}),j="array"===c,k=j?[]:{},g(k,a,function(a){j?k.push(a.value):k[a.key]=a.value})}function e(a,b,c){if(avalon.isObject(a)&&!Array.isArray(a)){var d=[];return g(d,b,function(b){d.push(a.hasOwnProperty(b)?a[b]:c?c[b]:"")})}return a}function f(a,b,c){var e,f,i,j,d=avalon.type(a);if("array"!==d&&"object"!==d)throw"limitBy只能处理对象或数组";if(b=1/0===Math.abs(Number(b))?Number(b):parseInt(b,10),Number.isNaN(b))return a;for("object"===d&&(a=h(a)),b=Math.min(a.length,b),c=!c||Number.isNaN(c)?0:~~c,0>c&&(c=Math.max(0,a.length+c)),e=[],f=c;b>f;f++)e.push(a[f]);return(i="array"===d)?e:(j={},g(j,e,function(a){j[a.key]=a.value}))}function g(a,b,c){for(var d=0,e=b.length;e>d;d++)c(b[d]);return a}function h(a){var b=[],c=0;return avalon.each(a,function(a,d){b[c++]={value:d,key:a}}),b}Number.isNaN=Number.isNaN||function(a){return a!==a},a.exports={limitBy:f,orderBy:c,selectBy:e,filterBy:d}},function(a){var c={stop:function(a){return a.stopPropagation(),a},prevent:function(a){return a.preventDefault(),a}},d={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(d,function(a,b){c[a]=function(a){return a.which!==b&&(a.$return=!0),a}}),a.exports=c},function(a,b,c){var d=c(16),e=c(17),f=c(18);avalon.vdomAdaptor=function(a,b){if(!a)return"toHTML"===b?"":avalon.avalonFragment.cloneNode(!1);switch(a.nodeType){case 3:return d.prototype[b].call(a);case 8:return e.prototype[b].call(a);default:return f.prototype[b].call(a)}},a.exports={VText:d,VComment:e,VElement:f}},function(a){function d(a){if("string"==typeof a)this.type="#text",this.nodeValue=a,this.skipContent=!c.test(a),this.nodeType=3;else for(var b in a)this[b]=a[b]}var c=avalon.config.rexpr;d.prototype={constructor:d,toDOM:function(){return document.createTextNode(this.nodeValue)},toHTML:function(){return this.nodeValue}},a.exports=d},function(a){function c(a){if("string"==typeof a)this.type="#comment",this.nodeValue=a,this.skipContent=!0,this.nodeType=8;else for(var b in a)this[b]=a[b]}c.prototype={constructor:c,toDOM:function(){return document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},a.exports=c},function(a){function c(a,b,c){if("object"==typeof a)for(var d in a)this[d]=a[d];else this.nodeType=1,this.type=a,this.props=b,this.children=c,this.template=""}function d(a){return a!==!1&&Object(a)!==a}var e={"class":function(a,b){a.className=b},style:function(a,b){a.style.cssText=b},"for":function(a,b){a.htmlFor=b}};c.prototype={constructor:c,toDOM:function(){var b,c,f,a=document.createElement(this.type);for(b in this.props)c=this.props[b],d(c)&&(e[b]&&avalon.msie<8?e[b](a,c):a.setAttribute(b,c+""));if(this.skipContent)switch(this.type){case"script":a.text=this.template;break;case"style":case"template":a.innerHTML=this.template;break;case"noscript":a.textContent=this.template;break;default:f=avalon.parseHTML(this.template),a.appendChild(f)}else this.isVoidTag||(this.children.length?this.children.forEach(function(b){b&&a.appendChild(avalon.vdomAdaptor(b,"toDOM"))}):a.appendChild(avalon.parseHTML(this.template)));return a},toHTML:function(){var b,c,e,a=[];for(b in this.props)c=this.props[b],d(c)&&a.push(b+"="+avalon.quote(this.props[b]+""));return a=a.length?" "+a.join(" "):"",e="<"+this.type+a,this.isVoidTag?e+"/>":(e+=">",e+=this.children.length?this.children.map(function(a){return a?avalon.vdomAdaptor(a,"toHTML"):""}).join(""):this.template,e+"</"+this.type+">")}},a.exports=c},,,,,,,,function(a){function c(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var d=c.prototype;d.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},d.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key])},d.get=function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},a.exports=c},function(a){function e(a){var f,e,g,b="undefined"!=typeof a.querySelectorAll?a.querySelectorAll("script"):a.getElementsByTagName("script");if(b.length)for(e=0;f=b[e++];)d[f.type]&&(g=c.cloneNode(!1),Array.prototype.forEach.call(f.attributes,function(a){a&&a.specified&&(g[a.name]=a.value,g.setAttribute(a.name,a.value))}),g.text=f.text,f.parentNode.replaceChild(g,f))}var c=avalon.document.createElement("script"),d=avalon.oneObject(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]);a.exports=e},,,,,function(a){a.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},,function(a){function d(a,b){var h,e,i,j,k,l,m;for(e=0;h=a[e++];)1===h.nodeType&&(i=g(h),i&&++c,j=avalon.vmodels[i],j&&!j.$element?(f(h),avalon(h).removeClass("ms-controller"),j.$element=h,k=new Date,h.vtree=avalon.lexer(h.outerHTML.trim()),l=new Date,avalon.log("create primitive vtree",l-k),j.$render=avalon.render(h.vtree),m=new Date,avalon.log("create template Function ",m-l),avalon.rerenderStart=m,avalon.batch(i,!0),"function"==typeof b&&b(j)):i||d(h.childNodes,b))}function f(a){var b,c,d;for(c=0;c<a.childNodes.length;c++)d=a.childNodes[c],3!==d.nodeType||e.test(d.nodeValue)?1===d.nodeType&&f(d):(b=a.removeChild(d),c--);0===a.childNodes.length&&b&&a.appendChild(b)}function g(a){return a.getAttribute("ms-controller")}var c=0,e=/\S/;a.exports=avalon.scan=function(a,b){return a&&a.nodeType?(d([a],b),c=0,void 0):(avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document"),void 0)}},,function(a,b,c){var d=c(37),e=c(43);avalon.important=function(a,b){var e,f,g,c=a.props.wid,d=avalon.vmodels[b];return d?"string"==typeof avalon.caches[c]?(e=avalon.caches[c],e="__vmodel__ =  avalon.vmodels["+avalon.quote(b)+"]\n"+e,f=Function("__vmodel__",e),g=f(),a=avalon.caches[c]=g[0],a.order="ms-important",a.skipAttrs=!1,a.props["ms-important"]=b,a.render=f,a):(a=avalon.caches[c],a.skipAttrs=a.skipContent=!0,a):a},avalon.directive("important",{priority:1,parse:function(a,b,c){var e,f;return delete c.props["ms-important"],e=c.props.wid||(c.props.wid=avalon.makeHashCode("w")),f=d([c],b)+"\n\nreturn vnodes"+b,avalon.caches[e]=f,c.isVoidTag=!0,["vnode"+b+".props.wid = "+avalon.quote(e),"vnode"+b+" = avalon.important(vnode"+b+","+avalon.quote(a.expr)+")"].join("\n")+"\n"},diff:function(a,b,c,d){b.props[d]!==a.props[d]&&e(a,this.update,c,"important")},update:function(a,b){var c=b.props["ms-important"],d=avalon.vmodels[c];d.$render=b.render,d.$element=a}})},function(a,b,c){function m(a){return k.test(a)?a:d(a,"text")}function n(a,b){return"(function(){\n\n"+a+"\n\nreturn vnodes"+b+"\n})();\n"}function q(a,b){var i,j,k,r,s,t,u,v,w,x,y,z,A,B,C;for(b=b||String(new Date-0).slice(0,5),i=[],j=!1,k="vnodes"+b,r="vnode"+b,s="var "+k+" = []\n",t=0;t<a.length;t++)u=a[t],3!==u.nodeType?8!==u.nodeType?(s+="var "+r+" = {"+"\n	nodeType:1,"+"\n	type: "+h(u.type)+","+"\n	props:{},"+"\n	children: [],"+"\n	isVoidTag: "+!!u.isVoidTag+","+'\n	template: ""}\n',A=u.props["ms-widget"],!A&&u.type.indexOf("-")>0&&!u.props.resolved&&(u.props["ms-widget"]="@"+u.type.replace(/-/g,"_")),B="",C=u.props["ms-controller"],B=e(u.props,b,u),B&&(s+=B),u.isVoidTag||(u.children.length?(j=u.props["ms-if"],j&&(s+="if("+r+"&&"+r+".nodeType === 1 ){\n"),s+=r+".children = "+n(q(u.children,b),b)+"\n",j&&(s+="}\n")):s+=r+".template = "+h(u.template)+"\n"),s+=k+".push("+r+")\n",C&&(s+="}")):(y=u.nodeValue,o.test(y)?(0!==y.indexOf("ms-for:")&&avalon.error("ms-for指令前不能有空格"),z=u.signature,i.push(z),s+="\nvar "+z+" = {"+"\n	nodeType:8,"+'\n	type:"#comment",'+"\n	vmodel:__vmodel__,"+'\n	directive:"for",'+"\n	skipContent:false,"+"\n	cid:"+h(u.cid)+","+"\n	start:"+k+".length,"+"\n	signature:"+h(z)+","+"\n	template:"+h(u.template)+","+"\n	nodeValue:"+h(y)+"\n}\n",s+=k+".push("+z+")\n",s+=avalon.directives["for"].parse(u,b)):p.test(y)?(z=i[i.length-1],0!==y.indexOf("ms-for-end:")&&avalon.error("ms-for-end指令前不能有空格"),s+=k+".push({"+"\n	nodeType: 8,"+'\n	type:"#comment",'+"\n	skipContent: true,"+"\n	nodeValue:"+h(z)+","+"\n	key:traceKey\n})\n",s+="\n})\n",i.length&&(z=i[i.length-1],s+=z+".end ="+k+".push({"+"\n	nodeType: 8,"+'\n	type:"#comment",'+"\n	skipContent: true,"+"\n	signature: "+h(z)+","+'\n	nodeValue: "ms-for-end:"'+"\n})\n",i.pop())):s+=0===y.indexOf("ms-js:")?d(y.replace("ms-js:",""),"js")+"\n":k+".push("+h(u)+")\n\n\n"):(s+="var "+r+' = {type:"#text",nodeType:3,skipContent:true}\n',v=g.rexpr.test(u.nodeValue),v?(w=f(u.nodeValue),1===w.length?(x=d(w[0].expr),s+=r+".nodeValue = "+m(w[0].expr)+"\n"):(x=w.map(function(a){return a.type?m(a.expr):h(a.expr)}).join(" + "),s+=r+".nodeValue = String("+x+")\n"),s+=r+".fixIESkip = true\n",s+=r+".skipContent = false\n"):s+=l.test(u.nodeValue)?r+'.nodeValue = "\\n"\n':r+".nodeValue = "+h(u.nodeValue)+"\n",s+=k+".push("+r+")\n");return s}var j,k,l,o,p,d=c(38),e=c(41),f=c(42),g=avalon.config,h=avalon.quote;avalon.makeHashCode,j=c(40),k=j.ident,l=j.sp,o=/^\s*ms\-for:/,p=/^\s*ms\-for\-end:/,avalon.htmlFactory=function(a,b){var d,c=avalon.lexer(a+"");return avalon.__html=[],d=q(c,b)+"\nreturn (avalon.__html = vnodes"+b+")",{render:d}},a.exports=q},function(a,b,c){function o(a,b){function t(a){var b="??"+r++;return s[b]=a,b}function u(a){return s[a]}var o,q,r,s,v,w,x,y,z,A,B,c={};if(b=b||"other","object"==typeof a&&(b=a.type,c=a,a=c.expr),"string"!=typeof a)return"";if(o=a,q=d.get(b+":"+o))return q;if(r=1,s={},v=a.replace(e,t).replace(f,t).replace(i,t).replace(k,"$1").split(j),w=v.shift().replace(g,u).trim(),"on"===b&&n.test(w)&&(w+="($event)"),w=w.replace(m,"$1__vmodel__."),"js"===b)return d.put(b+":"+o,w);if(x=v.map(function(a){a=a.replace(g,u).replace(m,"$1__vmodel__.");var b=!1;return a=a.replace(h,function(a,c){return b=!0,/\S/.test(c)?"(__value__,"+c+");":"(__value__);"}),b||(a+="(__value__);"),a=a.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+a}),y=[],"on"===b)x=x.map(function(a){return a.replace(/__value__/g,"$event")}),x.length&&x.push("if($event.$return){\n	return;\n}"),avalon.modern||(w=w.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(a,b,c){return"__vmodel__."+b+".call(__vmodel__"+(/\S/.test(c)?","+c:"")+")"})),y=["function ms_on($event){","try{","	var __vmodel__ = this;","	"+w,"}catch(e){",p(a,b),"}","}"],x.unshift(2,0);else{if("duplex"===b)return z=["function (__vmodel__){","try{","return "+w+"\n","}catch(e){",p(a,b),"}","}"],d.put("duplex:"+o,l(z)),A=["function (__vmodel__,__value__){","try{","	"+w+" = __value__","}catch(e){",p(a,b),"}","}"],d.put("duplex:set:"+o,l(A)),v.length&&(B=["function (__vmodel__, __value__){","try{",x.join("\n"),"return __value__\n","}catch(e){",p(a,b),"}","}"],d.put("duplex:format:"+o,l(B))),void 0;y=["(function(){","try{","var __value__ = "+w,"text"===b?'return __value__ == null ? "" :__value__':"return __value__","}catch(e){",p(a,b),'	return ""',"}","})()"],x.unshift(3,0)}return y.splice.apply(y,x),q=y.join("\n"),d.put(b+":"+o,q),q}function p(a,b){return"	avalon.warn(e, "+avalon.quote("parse "+b+" binding【 "+a+" 】fail")+")"}var d=c(39),e=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,f=c(40).string,g=/\?\?\d+/g,h=/\(([^)]*)\)/,i=/\|\|/g,j=/\|(?=\w)/,k=/\s*(\.|\|)\s*/g,l=function(a){return"(function(){ return "+a.join("\n")+"})();\n"},m=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,n=/^(?:\@|##)[$\w]+$/i;a.exports=avalon.parseExpr=o},function(a,b,c){var d=c(26);a.exports=new d(512)},function(a){a.exports={ident:/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,sp:/^\s+$/,leftSp:/^\s+/,rightSp:/s+$/,binding:/^ms-(\w+)-?(.*)/,string:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g}},function(a,b,c){function j(a,b,c){var o,q,p,r,s,t,u,v,w,x,j=[],l="ms-skip"in a,m="",n={};for(o in a)p=a[o],!l&&(q=o.match(g))?(r=q[1],s=q[2]||"",t=o,h[r]&&(u=parseFloat(s)||0,s=r,r="on"),t="ms-"+r+(s?"-"+s:""),o!==t&&(delete a[o],a[t]=p),f[r]&&(v={type:r,param:s,name:t,expr:p,priority:f[r].priority||100*r.charCodeAt(0)},"on"===r&&(u=u||0,v.name+="-"+u,v.priority+=100*s.charCodeAt(0)+u),n[v.name]||(n[v.name]=1,j.push(v)))):m+=d.test(o)||i[o]?"vnode"+b+".props["+e(o)+"] = "+e(p)+"\n":"vnode"+b+".props."+o+" = "+e(p)+"\n";return j.length?(j.sort(k),m+="vnode"+b+'.order = "'+j.map(function(a){return a.name}).join(";;")+'"\n',w=j[0],x=w&&"widget"===w.type,x?(j.shift(),j.forEach(function(a){m+="vnode"+b+".props["+e(a.name)+"] = "+e(a.expr)+"\n"}),m+=f["widget"].parse(w,b,c)):j.forEach(function(a){m+=f[a.type].parse(a,b,c)})):m+="	vnode"+b+".skipAttrs = true\n",m}function k(a,b){return a.priority-b.priority}var d=/[W-]/,e=avalon.quote,f=avalon.directives,g=c(40).binding,h=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),i=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");a.exports=j},function(a,b,c){function g(a){for(var c,h,i,b=[],g=0;;){if(h=a.indexOf(f.openTag,g),-1===h)break;if(c=a.slice(g,h),0===g&&(c=c.replace(e.leftSp,"")),c&&b.push({expr:c}),g=h+f.openTag.length,h=a.indexOf(f.closeTag,g),-1===h)break;c=a.slice(g,h),c&&b.push({expr:c.replace(d,""),type:"{{}}"}),g=h+avalon.config.closeTag.length}return c=a.slice(g),i=c.replace(e.rightSp,""),i&&b.push({expr:i}),b}var d=/\r?\n/g,e=c(40),f=avalon.config;a.exports=g},function(a){a.exports=function(a,b,c,d,e){e=e||"change";var f=a[e]||(a[e]=[]);avalon.Array.ensure(f,b)&&(c.count+=1,avalon.config.showDiff&&avalon.log(d+" change"))}},function(a,b,c){var d=c(43);avalon.skipController=function(a,b){if(a){var d=b.$render?b.$render.$id:b.$id;return a.length>d.length?0!==a.indexOf(d+";;"):0!==d.indexOf(a)}return!1},avalon.directive("controller",{priority:2,parse:function(a,b,c){var e,f,d=avalon.quote(a.expr);return delete c.props["ms-controller"],e="vm"+b,f=["if(!vnodes"+b+".vm){ vnodes"+b+".vm = __vmodel__}","__vmodel__ = vnodes"+b+".vm || __vmodel__","vnode"+b+'.props["ms-controller"] = '+d+";","var "+e+" = avalon.vmodels["+d+"]","if(!"+e+"){return }","vnode"+b+".bottom = "+e,"if(__vmodel__){","vnode"+b+".top = __vmodel__",'var __id__ = __vmodel__.$id+ "_" + '+d,"__vmodel__ = avalon.caches[__id__] || (avalon.caches[__id__] = avalon.mediatorFactory(__vmodel__,"+e+"))","vnode"+b+".mediator = __vmodel__","}else{","__vmodel__ = "+e,"}","if(!avalon.skipController(__fast__, vnode"+b+".bottom)){ "],f.join("\n")+"\n"},diff:function(a,b,c,e){b.props[e]!==a.props[e]&&d(a,this.update,c,"controller")},update:function(a,b){function g(){return f(0,g.$id)}var f,c=b.top,d=b.bottom,e=b.mediator;c&&d&&(d.$element=c&&c.$element||a,b.top=b.mediator=b.bottom=0,d.$render||(f=c.$render,f.$id||(f.$id=c.$id),d.$render=g,g.dom=d.$element,g.$id=f.$id+";;"+d.$id,e&&(e.$render=g)))}})},,,function(a){var e,c={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},d=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");d.replace(/\w+/g,function(a){c[a.toLowerCase()]=a}),e=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(","),e.replace(/\w+/g,function(a){c[a.toLowerCase()]=a}),a.exports=c},function(a,b,c){var d=c(43);avalon.directive("css",{parse:function(a,b){return"vnode"+b+'.props["ms-css"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,e){var h,i,j,f=a.props[e],g=b.props[e];if(Object(f)===f){if(Array.isArray(f)&&(f=a.props[e]=avalon.mix.apply({},f)),"object"!=typeof g)a.changeStyle=f;else{h={},i=!1;for(j in f)f[j]!==g[j]&&(i=!0,h[j]=f[j]);i&&(a.changeStyle=h)}a.changeStyle&&d(a,this.update,c,"css")}else a.props[e]=g},update:function(a,b){var e,c=b.changeStyle,d=avalon(a);for(e in c)d.css(e,c[e]);delete b.changeStyle}})},function(a,b,c){function f(a,b){var h,c=a.ownerDocument,d=a.nodeName,g="_"+d;return f[g]||(h=c.body.appendChild(c.createElement(d)),b=avalon.modern?getComputedStyle(h,null).display:h.currentStyle.display,c.body.removeChild(h),b===e&&(b="block"),f[g]=b),f[g]}var d=c(43),e="none";avalon.parseDisplay=f,avalon.directive("visible",{parse:function(a,b){return"vnode"+b+'.props["ms-visible"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,e){var f=a.props[e]=!!a.props[e];a.displayValue=b.displayValue,f!==b.props[e]&&d(a,this.update,c,"visible")},update:function(a,b){function h(){void 0!==g&&(a.style.display=g)}var g,c=b.props["ms-visible"],d=a.style.display;c?(d===e&&(g=b.displayValue,g||(a.style.display="")),""===a.style.display&&avalon(a).css("display")===e&&avalon.contains(a.ownerDocument,a)&&(g=f(a))):d!==e&&(g=e,b.displayValue=d),avalon.applyEffect(a,b,{hook:c?"onEnterDone":"onLeaveDone",cb:h})}})},,function(a,b,c){var d=c(40).ident,e=c(43);avalon.directive("text",{parse:function(a,b,c){c.children=[{type:"#text",nodeType:3,nodeValue:""}];var e=d.test(a.expr)?a.expr:avalon.parseExpr(a);return"vnode"+b+'.props["ms-text"] ='+e+"\n"},diff:function(a,b,c,d){var h,f=a.props[d],g=b.props[d];return a.children=b.children,h=a.dom=b.dom,a.skipContent=!0,(f!==g||0===a.children.length)&&(a.children[0]||(a.children[0]={type:"#text",nodeType:3}),a.children[0].nodeValue=f,h?this.update(h,a):e(a,this.update,c,"text")),b.dom=null,!1},update:function(a,b){var c=b.props["ms-text"];"textContent"in a?a.textContent=c+"":a.innerText=c+"",b.dom=a}})},function(a,b,c){var d=c(43);avalon.directive("html",{parse:function(a,b,c){var e,d=!!c.isVoidTag;return c.isVoidTag=!1,e=["var htmlId =  "+avalon.parseExpr(a),"vnode"+b+'.props["ms-html"]  = htmlId;',"vnode"+b+"._isVoidTag  = "+d,"var obj  = avalon.htmlFactory(htmlId,"+b+");",'try{eval(" new function(){"+ obj.render +"}")}catch(e){};',"vnode"+b+".children = avalon.__html;"],e.join("\n")+"\n"},diff:function(a,b,c,e){var f=a.props[e],g=b.props[e];a.isVoidTag=a._isVoidTag,f!==g&&d(a,this.update,c,"html")},update:function(a,b){if(1===a.nodeType){avalon.clearHTML(a);var c=document.createDocumentFragment();b.children.forEach(function(a){a&&c.appendChild(avalon.vdomAdaptor(a,"toDOM"))}),a.appendChild(c)}}})},function(a,b,c){function g(a){return Object.keys(a).filter(function(b){return a[b]}).join(" ")}function i(a){var b=a.target;avalon(b).addClass(b.getAttribute(h[a.type])||"")}function j(a){var b=a.target,c=h[a.type];avalon(b).removeClass(b.getAttribute(c)||""),"change-active"!==c&&avalon(b).removeClass(b.getAttribute("change-active")||"")}function k(a,b){var c=a.getAttribute("old-change-class")||"",d=b.props["ms-class"];avalon(a).removeClass(c).addClass(d),a.setAttribute("old-change-class",d)}var h,d=c(6).getLongID,e=c(43),f=avalon.directives;avalon.directive("class",{parse:function(a,b){return"vnode"+b+'.props["'+a.name+'"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,d){var l,m,f=d.slice(3),h=a.props[d],k=b.props[d];b.classEvent?a.classEvent=b.classEvent:(l={},"hover"===f?(l.mouseenter=i,l.mouseleave=j):"active"===f&&(a.props.tabindex=a.props.tabindex||-1,l.tabIndex=a.props.tabindex,l.mousedown=i,l.mouseup=j,l.mouseleave=j),a.classEvent=l),b.classEvent=null,m=avalon.noop,Array.isArray(h)?m=h.map(function(a){return a&&"object"==typeof a?g(a):a?a:""}).join(" "):avalon.isObject(h)?m=g(h):h!==!1&&null!==h&&void 0!==h&&(m=String(h)),m!==avalon.noop&&(m=a.props[d]=m.trim().replace(/\s+/," "),k!==m&&(a["change-"+f]=m,e(a,this.update,c,f)))},update:function(a,b){var c,d,e;if(a&&1===a.nodeType){if(c=b.classEvent){for(d in c)"tabIndex"===d?a[d]=c[d]:avalon.bind(a,d,c[d]);b.classEvent={}}e=["class","hover","active"],e.forEach(function(c){var f,d="change-"+c,e=b[d];void 0!==e&&("class"===c?a&&k(a,b):(f=a.getAttribute("change-"+c),f&&avalon(a).removeClass(f),a.setAttribute(d,e)))})}}}),f.active=f.hover=f["class"],h={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"},d(i),d(j)},function(a,b,c){var d=c(6).getLongID,e=c(26),f=new e(128),g=avalon.quote,h=c(43),i=/^ms-on-([a-z]+)/,j=/\|.+/g,k=/((?:\@|\$|\#\#)?\w+)/g,l=c(40).string;avalon.directive("on",{priority:3e3,parse:function(a,b){var m,n,o,c=a.expr.replace(l," ").replace(j,"").match(k),e=c.every(function(a){return"@"===a.charAt(0)||"##"===a.slice(0,2)||"$event"===a}),h="vnode"+b+".onVm = __vmodel__\n",i=g(a.name);return e?(m=a.expr,n=f.get(m),n||(n=Function("return "+avalon.parseExpr(a,"on"))(),o=d(n),f.put(m,n)),avalon.eventListeners[o]=n,h+"vnode"+b+".props["+i+"] = avalon.eventListeners."+o+"\n"):h+"vnode"+b+".props["+i+"] = "+avalon.parseExpr(a,"on")+"\n"},diff:function(a,b,c,e){var j,k,l,m,f=a.props[e],g=(b.props||{})[e];if(f!==g){if("function"==typeof g&&"function"==typeof f)return j=g.uuid,f.uuid=j,avalon.eventListeners[j]=f,void 0;k=e.match(i),l=k[1],m=l+":"+d(f),a.addEvents=a.addEvents||{},a.addEvents[m]=f,h(a,this.update,c,"on")}},update:function(a,b){if(a&&!(a.nodeType>1)){var c,d,e;a._ms_context_=b.onVm,delete b.onVm;for(c in b.addEvents)d=c.split(":").shift(),e=b.addEvents[c],avalon.bind(a,d,e);b.dom=a,delete b.addEvents}}})},,function(a){function g(a){d[this.tagName].call(this,a),!this.caret&&this._ms_field_&&this._ms_field_.update.call(this)}var d,e,f,h,c=!1;try{d={},e=HTMLInputElement.prototype,f=HTMLTextAreaElement.prototype,h=HTMLInputElement.prototype,Object.getOwnPropertyNames(h),d["INPUT"]=Object.getOwnPropertyDescriptor(e,"value").set,Object.defineProperty(e,"value",{set:g}),d["TEXTAREA"]=Object.getOwnPropertyDescriptor(f,"value").set,Object.defineProperty(f,"value",{set:g}),c=!0
}catch(i){}a.exports=c},function(a){function g(a,b){var n,o,p,q,r,g=a.expr,j=b.props.type,k=a.param,l="checked"===k,m=b.field={parsers:[],formatters:[],modelValue:0/0,viewValue:0/0,validators:"",parse:h,format:i};l&&(d.test(j)?(m.isChecked=!0,m.type="radio"):k=null),n=b.props["data-duplex-changed"],n&&(o=n+":cb",avalon.caches[o]?m.callback=avalon.caches[o]:(p=Function("return "+avalon.parseExpr(n,"on")),avalon.caches[o]=m.callback=p())),q=avalon.parsers[k],q&&m.parsers.push(q),c.test(g)&&(f.test(j)?avalon.warn(j+"不支持change过滤器"):m.isChanged=!0),r=g.match(e),r&&(m.isChanged||(m.debounceTime=parseInt(r[1],10)||300)),a.expr=m.expr=g.trim(),/input|textarea|select/.test(b.type)?m.type||(m.type="select"===b.type?"select":"checkbox"===j?"checkbox":"radio"===j?"radio":"input"):"contenteditable"in b.props&&(m.type="contenteditable"),avalon.parseExpr(a,"duplex")}function h(a){for(var c,b=0;c=this.parsers[b++];)a=c.call(this,a);return a}function i(a){for(var b=this.formatters,c=b.length;c--;)a=b[c](a);return a}var c=/\|\s*change\b/,d=/^(?:checkbox|radio)$/,e=/\|\s*debounce(?:\(([^)]+)\))?/,f=/^(file|button|reset|submit|checkbox|radio|range)$/;a.exports=g},,function(a){function d(a){a.validator&&avalon.directives.validate.validate(a,!1),a.callback&&a.callback.call(a.vmodel,{type:"changed",target:a.element})}var c={input:function(a){var c,e,f,b=this;a=a||"value",c=b.element[a],e=c,c=b.format(c),f=b.parse(c),c=f+"",f!==b.modelValue&&(b.set(b.vmodel,f),d(b)),e!==c&&(b.viewValue=c,b.element[a]=c)},radio:function(){var b,a=this;a.isChecked?(b=a.modelValue=!a.modelValue,a.set(a.vmodel,b),d(a)):c.input.call(a)},checkbox:function(){var c,e,a=this,b=a.modelValue;Array.isArray(b)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),b=[b]),c=a.element.checked?"ensure":"remove",b[c]&&(e=a.parse(a.element.value),b[c](e),d(a))},select:function(){var a=this,b=avalon(a.element).val();b+""!=this.modelValue+""&&(b=Array.isArray(b)?b.map(function(b){return a.parse(b)}):a.parse(b),a.modelValue=b,a.set(a.vmodel,b),d(a))},contenteditable:function(){c.input.call(this,"innerHTML")}};a.exports=c},,function(a){a.exports=function(a,b){var e,c=b.field,d=b.props["ms-rules"];if(d&&!c.validator)for(;a&&1===a.nodeType;){if(e=a._ms_validator_){c.rules=d,c.validator=e,avalon.Array.ensure(e.fields,c)&&e.addField(c);break}a=a.parentNode}}},function(a,b,c){function g(){var a=this.data||{};return this.message.replace(f,function(b,c){return null==a[c]?"":a[c]})}var d=c(43),e=avalon.directive("validate",{parse:function(a,b){return"vnode"+b+'.props["ms-validate"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,f){var g=a.props[f],h=b.props[f];if(h&&h.onError&&h.addField)a.props[f]=h;else if(Object(g)===g){g.$id&&(g=g.$model),a.props[f]=g;for(f in e.defaults)g[f]||(g[f]=e.defaults[f]);g.fields=g.fields||[],d(a,this.update,c,"validate")}},update:function(a,b){var c=b.props["ms-validate"];a._ms_validator_=c,c.element=a,a.setAttribute("novalidate","novalidate"),c.validateAllInSubmit&&avalon.bind(a,"submit",function(a){a.preventDefault(),e.validateAll.call(c,c.onValidateAll)}),"function"==typeof c.onInit&&c.onInit.call(a)},validateAll:function(a){var b=this,c="function"==typeof a?a:b.onValidateAll,d=b.fields.filter(function(a){var c=a.element;return c&&!c.disabled&&b.element.contains(c)}).map(function(a){return e.validate(a,!0)}),f=[];Promise.all(d).then(function(a){var e,d,g;for(d=0;e=a[d++];)f=f.concat(e);b.deduplicateInValidateAll&&(g={},f=f.filter(function(a){var b=a.element,c=b.uniqueID||(b.uniqueID=setTimeout("1"));return g[c]?!1:(g[c]=!0,!0)})),c.call(b.element,f)})},addField:function(a){var b=this,c=a.element;!b.validateInKeyup||a.isChanged||a.debounceTime||avalon.bind(c,"keyup",function(b){e.validate(a,0,b)}),b.validateInBlur&&avalon.bind(c,"blur",function(b){e.validate(a,0,b)}),b.resetInFocus&&avalon.bind(c,"focus",function(d){b.onReset.call(c,d,a)})},validate:function(a,b,c){var i,j,k,l,m,n,o,p,d=[],e=a.get(a.vmodel),f=a.element,h=a.validator;if(!f.disabled){for(i in a.rules)j=a.rules[i],j!==!1&&(k=avalon.validators[i],d.push(new Promise(function(a,b){l=a,m=b})),n=function(b){if(a.norequired&&""===e&&(b=!0),b)l(!0);else{var c={element:f,data:a.data,message:f.getAttribute("data-"+i+"-message")||f.getAttribute("data-message")||k.message,validateRule:i,getMessage:g};l(c)}},a.data={},a.data[i]=j,k.get(e,a,n));return o=[],p=Promise.all(d).then(function(a){for(var e,d=0;e=a[d++];)"object"==typeof e&&o.push(e);return b||(o.length?h.onError.call(f,o,c):h.onSuccess.call(f,o,c),h.onComplete.call(f,o,c)),o})}}}),f=/\\?{{([^{}]+)\}}/gm;e.defaults={addField:e.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onReset:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(){function c(a){return"regexp"===avalon.type(a)}function f(a){var b,c,d,e,f;return"string"==typeof a&&a&&(b=a.split("-"),3===b.length&&4===b[0].length)?(c=~~b[0],d=~~b[1]-1,e=~~b[2],f=new Date(c,d,e),f.getFullYear()===c&&f.getMonth()===d&&f.getDate()===e):!1}var d,e;avalon.directive("rules",{parse:function(a,b){var c=a.expr;return/{.+}/.test(c)?"vnode"+b+'.props["ms-rules"] = '+avalon.parseExpr(a)+";\n":void 0},diff:avalon.noop}),d=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,e=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(a,b,d){var g,e=b.element,f=b.data;return c(f.pattern)||(g=e.getAttribute("pattern"),f.pattern=new RegExp("^(?:"+g+")$")),d(f.pattern.test(a)),a}},digits:{message:"必须整数",get:function(a,b,c){return c(/^\-?\d+$/.test(a)),a}},number:{message:"必须数字",get:function(a,b,c){return c(isFinite(a)),a}},required:{message:"必须填写",get:function(a,b,c){return c(""!==a),a}},equalto:{message:"密码输入不一致",get:function(a,b,c){var d=String(b.data.equalto),e=avalon(document.getElementById(d)).val()||"";return c(a===e),a}},date:{message:"日期格式不正确",get:function(a,b,c){var d=b.data;return"regexp"===avalon.type(d.date)?c(d.date.test(a)):c(f(a)),a}},url:{message:"URL格式不正确",get:function(a,b,c){return c(e.test(a)),a}},email:{message:"email格式不正确",get:function(a,b,c){return c(d.test(a)),a}},minlength:{message:"最少输入{{minlength}}个字",get:function(a,b,c){var d=parseInt(b.data.minlength,10);return c(a.length>=d),a}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(a,b,c){var d=parseInt(b.data.maxlength,10);return c(a.length<=d),a}},min:{message:"输入值不能小于{{min}}",get:function(a,b,c){var d=parseInt(b.data.min,10);return c(parseFloat(a)>=d),a}},max:{message:"输入值不能大于{{max}}",get:function(a,b,c){var d=parseInt(b.data.max,10);return c(parseFloat(a)<=d),a}},chs:{message:"必须是中文字符",get:function(a,b,c){return c(/^[\u4e00-\u9fa5]+$/.test(a)),a}}})},function(a,b,c){var d=c(65),e=c(43);avalon.directive("if",{priority:6,parse:function(a,b){var c="vnode"+b,d=["var ifVar = "+avalon.parseExpr(a,"if"),c+'.props["ms-if"] = ifVar;',"if(!ifVar){",c+".nodeType = 8;",c+'.directive="if";',c+'.nodeValue="ms-if"',"}"];return d.join("\n")+"\n"},diff:function(a,b,c){a.dom=b.dom,a.nodeType!==b.nodeType&&(a.steps=c,e(a,this.update,c,"if"))},update:function(a,b,c){var g,h,i,j,e=a.nodeType,f=b.nodeType;if(e!==f){if(1===f){if(g=b.dom,!g){g=avalon.vdomAdaptor(b,"toDOM"),b.dom=g,h=b.props;for(i in h)i.match(/ms\-on/g)&&(j=h[i],"function"==typeof j&&(g._ms_context_=b.onVm,avalon.bind(g,i.split("-")[2],j)));b.onVm&&delete b.onVm}return c.replaceChild(g,a),b.steps.count&&d([g],[b],c,b.steps),avalon.applyEffect(a,b,{hook:"onEnterDone"}),b.steps=!1}8===f&&avalon.applyEffect(a,b,{hook:"onLeaveDone",cb:function(){var d=a._ms_if_||(a._ms_if_=document.createComment(b.nodeValue));c.replaceChild(d,a)}})}}})},function(a){function d(a,b,g,h){var j,k,l,m,n,o,p,i=a[0];if((i||g)&&h.count)for(g=g||i.parentNode,j=0,k=b.length;k>j;j++)if(l=b[j],m=i,!(avalon.msie<9&&!l.fixIESkip&&3===l.nodeType&&c.test(l.nodeValue))){if(m&&(i=m.nextSibling),"for"===l.directive&&l.forDiff){if(!m)return;1===m.nodeType?(n=document.createComment(l.nodeValue),g.insertBefore(n,m),l.endRepeat=document.createComment("ms-for-end:"),g.insertBefore(l.endRepeat,m.nextSibling),m=n):l.endRepeat||(l.endRepeat=e(m)),8!==m.nodeType&&(m=m.nextSibling),i=l.endRepeat.nextSibling}if(!1!==f(m,l,g,h,"change")){if(!l.skipContent&&l.children&&m&&1===m.nodeType&&d(avalon.slice(m.childNodes),l.children,m,h),o=l.props&&l.props["ms-controller"],o&&m&&(p=avalon.vmodels[o],p.$render&&(p.$render.dom=m)),f(m,l,g,h,"afterChange"),!h.count)break}else l.repeatCount&&(j+=l.repeatCount+1),f(m,l,g,h,"afterChange")}}function e(a){for(var a,b=0,c=[];a&&(8===a.nodeType&&(0===a.nodeValue.indexOf("ms-for:")?++b:0===a.nodeValue.indexOf("ms-for-end:")&&--b),c.push(a),a=a.nextSibling,0!==b););return c.pop()}function f(a,b,c,d,e){var g,f=b[e];if(f){for(;g=f.shift();)if(d.count-=1,!1===g(a,b,c))return!1;delete b[e]}}var c=/^\s*$/;a.exports=d},function(a,b,c){function m(a){var b=typeof a;return a&&"object"===b?a.$hashcode:b+a}function n(a){var b,c,d;if(Array.isArray(a))return a.length+"|"+a.map(m).join(";;");b=0,c=[];for(d in a)a.hasOwnProperty(d)&&(b++,c.push(d+"*"+a[d]));return b+"|"+c.join(";;")}function o(a){var b=n(a.enume);a.compareText=b}function q(a,b){var f,e,c=[],d={children:[]};for(e=0;f=a[e];e++)8===f.nodeType&&f.nodeValue===b?(d.children.push(f),d.key=f.key,d.index=c.length,c.push(d),d={children:[]}):d.children.push(f);return c}function t(a,b){var d,e,f,c=b.match(r);if(c){d=c[1];for(e in a)if(f=e.match(s),f&&f[1]===d)return u(a,e)}}function u(a,b){var e,f,g,c=a[b],d=b;if(c){if(e=a["***"+b])return f=e.pop(),delete a[f.id],0==e.length&&delete a["***"+b],f.c;for(g=[{id:b,c:c}];;){if(b+="_",!a[b])break;g.push({id:b,c:a[b]})}return f=g.pop(),delete a[f.id],g.length&&(a["***"+d]=g),f.c}return c}function v(a,b){var c=b.key;if(a[c]){for(;;)if(c+="_",!a[c]){a[c]=b;break}}else a[c]=b}var r,s,w,d=c(65),e=/ms-for\:\s*/,f=/^\s*\(\s*/,g=/\s*\)\s*$/,h=/\s*,\s*/,i=/\s+as\s+([$\w]+)/,j=c(40).ident,k=c(43),l=/^(null|undefined|NaN|window|this|\$index|\$id)$/;avalon._each=function(a,b){var c,d,e;if(Array.isArray(a))for(c=0;c<a.length;c++)d=a[c],e=m(d),b(c,d,e);else for(c in a)a.hasOwnProperty(c)&&b(c,a[c],c)},avalon.directive("for",{priority:3,parse:function(a,b){var d,k,m,n,o,p,c=a.nodeValue;return c=c.replace(i,function(a,b){return!j.test(b)||l.test(b)?avalon.error("alias "+b+" is invalid --- must be a valid JS identifier which is not a reserved name."):d=b,""}),k=c.replace(e,"").split(" in "),m="var loop"+b+" = "+avalon.parseExpr(k[1])+"\n",n=a.signature+".enume = loop"+b+"\n",o=d?"var "+d+" = loop"+b+"\n":"",p=k[0].replace(f,"").replace(g,"").split(h),1===p.length&&p.unshift("$key"),m+n+o+"avalon._each(loop"+b+", function("+p+", traceKey){\n"},diff:function(a,b,c,d){var g,i,j,l,h,m,n,p,r,s,w,x,e=a[d],f=b[d]||{};if(o(e),delete f.forDiff,e.compareText===f.compareText)return delete f.enume,avalon.shadowCopy(e,f),void 0;if(e.forDiff=!0,g=!("directive"in f),h=!1,g&&(f.components=[],f.repeatCount=0),m=f.components.length,n=a.slice(e.start,e.end),e.endRepeat=f.endRepeat,e.components=q(n.slice(1,-1),e.signature),p=Math.max(n.length-2,0)-f.repeatCount,p>0){for(r=[d+1,0],i=0,p-=1;p>i;i++)r.push(null);b.splice.apply(b,r)}else 0>p&&b.splice.apply(b,[d,Math.abs(p)]);if(e.action=g?"init":"update",g){for(s=c.count,w=e.cache={},i=0;j=e.components[i++];)avalon.diff(j.children,[],c),v(w,j);e.removedComponents={},h=0===e.components.length||c.count!==s}else{if(w=f.cache,!w)return;for(x=e.cache={},i=0;j=e.components[i++];)l=u(w,j.key),l?(h||(h=j.index!==l.index),m--,j.nodes=l.nodes,avalon.diff(j.children,l.children,c)):m&&(l=t(w,j.key),l&&(m--,h=!0,j.nodes=l.nodes,avalon.diff(j.children,l.children,c))),j.nodes||(h=!0,avalon.diff(j.children,[],c)),v(x,j);for(i in w){e.removedComponents=w,h=!0;break}}return f.components.length=0,delete f.cache,h&&(e.steps=c,k(e,this.update,c,"for")),d+n.length-1},update:function(a,b,c){var h,i,j,k,l,m,n,o,p,q,s,r,t,u,v,x,e=b.action,f=b.endRepeat,g=document.createDocumentFragment();if("init"===e){for(h=!1,i=a.nextSibling;i&&i!==f;){if(8===i.nodeType&&(h=i.nodeValue===b.signature)){b.hasRender=!0;break}i=i.nextSibling}if(!h)for(i=a.nextSibling;i&&i!==f;)c.removeChild(i),i=a.nextSibling}j=avalon.parseHTML(b.template),k=b.signature;for(l in b.removedComponents)m=b.removedComponents[l],m.nodes&&(m.nodes.forEach(function(a,b){a.parentNode&&avalon.applyEffect(a,m.children[b],{hook:"onLeaveDone",cb:function(){a.parentNode.removeChild(a)},staggerKey:k+"leave"})}),m.nodes.length=m.children.length=0);for(delete b.removedComponents,n=a,l=0;l<b.components.length;l++){if(o=b.components[l],p=o.nodes){if(n.nextSibling!==p[0]){for(q=g.cloneNode(!1),r=0;s=p[r++];)q.appendChild(s);c.insertBefore(q,n.nextSibling),w(o.nodes,o.children,{hook:"onMoveDone",staggerKey:k+"move"})}}else if(b.hasRender)for(p=o.nodes=[],n=n.nextSibling;n&&n!==b.endRepeat&&(p.push(n),n.nodeValue!==b.signature);)n=n.nextSibling;else t=j.cloneNode(!0),t.appendChild(document.createComment(b.signature)),p=o.nodes=avalon.slice(t.childNodes),c.insertBefore(t,n.nextSibling),w(o.nodes,o.children,{hook:"onEnterDone",staggerKey:k+"enter"});if(n=p[p.length-1],!n)break}return u=[],v=[],b.components.forEach(function(a){u.push.apply(u,a.nodes),v.push.apply(v,a.children)}),b.repeatCount=v.length,d(u,v,c,b.steps),x=avalon.caches[b.cid],x&&x.call(b.vmodel,{type:"rendered",target:a,endRepeat:f,signature:b.signature}),!1}}),r=/^(string|number|boolean)/,s=/^_*(string|number|boolean)/,w=function(a,b,c){b.forEach(function(d,e){avalon.applyEffect(a[e],b[e],c)})}},,,function(a,b,c){function g(a,b){for(var c in a)if(a[c]!==b[c])return!0;return!1}function i(){if(!h.lock){var a=h[0];a&&(i.lock=!0,a())}}function l(a){var b=k.test(a)?1e3:1;return parseFloat(a)*b}function m(a,b,c){var d=a[b];d=Array.isArray(d)?d:"function"==typeof d?[d]:[],d.forEach(function(a){a&&a(c)})}function o(a){var b=a.toLowerCase();return function(c){var g,k,o,p,e=this.el,f=avalon(e),j=isFinite(c.stagger)?1e3*c.stagger:0;j&&c.staggerKey&&(k=n.get(c.staggerKey)||n.put(c.staggerKey,{count:0,items:0}),k.count++,k.items++),o=k&&k.count||0,p=function(b){var j,f=b!==!1;e.animating=void 0,g=!0,j=f?"Done":"Abort",m(c,"on"+a+j,e),avalon.unbind(e,d.transitionEndEvent),avalon.unbind(e,d.animationEndEvent),k&&0===--k.items&&(k.count=0),c.queue&&(h.lock=!1,h.shift(),i())},m(c,"onBefore"+a,e),c[b]?c[b](e,function(a){p(a!==!1)}):d.css&&(f.addClass(c[b+"Class"]),"leave"===b?f.removeClass(c.enterClass+" "+c.enterActiveClass):"enter"===b&&f.removeClass(c.leaveClass+" "+c.leaveActiveClass),f.bind(d.transitionEndEvent,p),f.bind(d.animationEndEvent,p),setTimeout(function(){var a,h,i,k;g=0/0===avalon.root.offsetWidth,f.addClass(c[b+"ActiveClass"]),a=window.getComputedStyle(e),h=a[d.transitionDuration],i=a[d.animationDuration],k=l(h)||l(i),0===!k?p(!1):j||setTimeout(function(){g||p(!1)},k+130)},17+j*o))}}function p(a){a.acton||(a.action=a.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var h,j,k,n,d=c(70),e=c(26),f=c(43);avalon.directive("effect",{priority:5,parse:function(a,b){return"vnode"+b+'.props["ms-effect"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,d){var h,i,e=a.props[d];"string"==typeof e?(h=e,e=a.props[d]={is:h}):Array.isArray(e)&&(e=a.props[d]=avalon.mix.apply({},e)),e.action=e.action||"enter",Object(e)===e&&(i=b.props[d],(Object(i)!==i||g(e,i))&&f(a,this.update,c,"effect","afterChange"))},update:function(a,b,c,e){var f,g,j,k,l,m,n,o;if(!a.animating){if(a.animating=!0,f=b.props["ms-effect"],g=f.is,e=e||{},!g)return avalon.warn("need is option");if(j=avalon.effects,d.css&&!j[g]&&avalon.effect(g,{}),k=j[g],!k)return avalon.warn(g+" effect is undefined");if(l=e.action||f.action,m=avalon.Effect,"function"!=typeof m.prototype[l])return avalon.warn(l+" action is undefined");n=new m(a),o=avalon.mix(e,k,f),o.queue?(h.push(function(){n[l](o)}),i()):setTimeout(function(){n[l](o)},4)}}}),h=[],avalon.effects={},avalon.effect=function(a,b){avalon.effects[a]=b||{},d.css&&(b.enterClass||(b.enterClass=a+"-enter"),b.enterActiveClass||(b.enterActiveClass=b.enterClass+"-active"),b.leaveClass||(b.leaveClass=a+"-leave"),b.leaveActiveClass||(b.leaveActiveClass=b.leaveClass+"-active")),b.action||(b.action="enter")},j=function(a){this.el=a},avalon.Effect=j,j.prototype={enter:o("Enter"),leave:o("Leave"),move:o("Move")},k=/\d+s$/,n=new e(128),avalon.applyEffect=function(a,b,c){var g,d=c.cb,e=c.hook,f=b.props&&b.props["ms-effect"];f&&!avalon.document.hidden?(g=f[e],d&&(Array.isArray(g)?g.push(d):f[e]=g?[g,d]:[d]),p(c),a.animate=!0,avalon.directives.effect.update(a,b,0,avalon.shadowCopy({},c))):d&&d()}},function(a){var f,g,l,m,p,c=!1,d=!1,e=!1,h=avalon.cssName("transition-duration"),i=avalon.cssName("animation-duration"),j={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},k=avalon.window;for(m in j){if(k[m]){l=j[m];break}try{document.createEvent(m),l=j[m];break}catch(o){}}"string"==typeof l&&(c=!0,e=!0,f=l),j={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(m in j)if(k[m]){p=j[m];break}"string"==typeof p&&(d=!0,e=!0,g=p),a.exports={transition:c,animation:d,css:e,transitionEndEvent:f,animationEndEvent:g,transitionDuration:h,animationDuration:i}},function(a,b,c){function e(a,b,c){var e,f;return b=b||String(new Date-0).slice(0,6),e=d(a,b,c)+"\n\nreturn vnodes"+b,f=Function("__vmodel__","__fast__",e)}avalon.lexer=c(72),avalon.diff=c(73),avalon.batch=c(74);var d=c(37);avalon.render=e,a.exports=avalon},function(a,b,c){function w(a){var b="??"+v++;return u[b]=a,b}function x(a){var b=u[a];return b}function A(a){return y.test(a)?a.replace(z,"").replace(s,w):a}function B(a,b,c){var l,o,v,y,z,B,D,E,e=[];if(c=c||1,"number"!=typeof b?b=0:b+=1,b>=c&&!t.rbind.test(a))return e;for(b||(a=a.replace(s,w));;){if(l="",o=!1,v=a.match(j),v&&(l=v[0],o=new f(l.replace(q,x))),o||(v=a.match(k),v&&(l=v[0],o=new g(v[1].replace(q,x)),y=o.nodeValue,n.test(y)&&(z=e[e.length-1],z&&3===z.nodeType&&p.test(z.nodeValue)&&e.pop(),C(e)))),o||(v=a.match(h),v&&(l=v[0],B=v[1].toLowerCase(),l=H(l,B),v=l.match(i),D={},v[2]&&O(A(v[2]),D),E=l.slice(v[0].length,-1*(B.length+3)),o={nodeType:1,type:B,props:D,template:E.replace(q,x).trim(),children:[]},o=I(o,E,e,b,c))),o||(v=a.match(i),v&&(l=v[0],B=v[1].toLowerCase(),D={},v[2]&&O(A(v[2]),D),o={nodeType:1,type:B,props:D,template:"",children:[],isVoidTag:!0},I(o,"",e,b,c))),!o)break;e.push(o),a=a.slice(l.length),8===o.nodeType&&m.test(o.nodeValue)&&(o.signature=d("for"),a=a.replace(r,""))}return b||(u={}),e}function C(a){for(var c,b=1,d=a.length,e=[];(c=a[--d])&&(8!==c.nodeType||(m.test(c.nodeValue)?b-=1:n.test(c.nodeValue)&&(b+=1),0!==b));)e.push(avalon.vdomAdaptor(c,"toHTML"));return c.template=e.reverse().join("")}function H(a,b){var g,h,i,j,k,m,n,o,c=[],d=[],e=E[b+"open"]||(E[b+"open"]=new RegExp("<"+b+D,G)),f=E[b+"close"]||(E[b+"close"]=new RegExp("</"+b+">",G));for(a.replace(e,function(a,b){return c.push(("0000000000"+b+"<").slice(-10)),a.replace(F,"1")}).replace(f,function(a,b){d.push(("0000000000"+b+">").slice(-10))}),g=c.concat(d).sort(),h=g.join("").replace(l,""),i=0,j=0,k=0,m=h.length;m>k;k++)if(n=h.charAt(k),"<"===n?i+=1:i-=1,0===i){j=k;break}return o=parseFloat(g[j])+b.length+3,a.slice(0,o)}function I(a,b,c,e,g){var i,j,k,l,h=a.type;if("ms-skip"in a.props)a.skipContent=!0;else{switch(h){case"style":case"script":case"noscript":case"template":case"textarea":a.skipContent=!0,"textarea"===h&&(a.props.type="textarea");break;case"input":a.props.type||(a.props.type="text");case"xmp":a.children.push(new f(a.template));break;case"option":a.children.push(new f(Q(a.template)));break;default:a.isVoidTag||(i=B(b,e,g),a.children=i,"table"===h&&J(a.children))}j=a.props["ms-for"],j&&(k=a.props["data-for-rendered"],l=k+":cb",delete a.props["ms-for"],c.push({nodeType:8,type:"#comment",nodeValue:"ms-for:"+j,signature:d("for"),cid:l,template:avalon.vdomAdaptor(a,"toHTML")}),k&&!avalon.caches[l]&&(avalon.caches[l]=Function("return "+avalon.parseExpr(k,"on"))()),c.push(a),a={nodeType:8,skipContent:!0,type:"#comment",nodeValue:"ms-for-end:"})}return a}function J(a){var b,g,h,c=!1,d=0,e=0,f=a.length;for(g=0;f>g;g++)h=a[g],b?"tr"!==h.type&&1===h.nodeType?b=!1:(b.children.push(h),d++,a[g]=0):"tr"===h.type&&(b={nodeType:1,type:"tbody",template:"",children:[],props:{}},b.children.push(h),c=!0,0===e&&(e=g),a[g]=b);if(c)for(g=e;f>g&&(0!==a[g]||(a.splice(g,1),g--,d--,0!==d));g++);}function O(a,b){a.replace(N,"=").replace(L,function(a){var c=a.split("="),d=c[1]||"",e=c[0].toLowerCase();2===c.length&&0===d.indexOf("??")&&(d=d.replace(q,x).slice(1,-1).replace(K,"&").replace(M,'"')),b[e]=d})}function Q(a){return String(a).replace(P,"").trim()}var d=avalon.makeHashCode,e=c(15),f=e.VText,g=e.VComment,h=/^<([^\s>\/=.$<]+)(?:\s+[^=\s]+(?:=[^>\s]+)?)*\s*>(?:[\s\S]*)<\/\1>/,i=/^<([^\s>\/=.$<]+)\s*([^>]*?)\/?>/,j=/^[^<]+/,k=/^<!--([\w\W]*?)-->/,l=/\d+/g,m=/^\s*ms-for\:/,n=/^\s*ms-for-end\:/,o=c(40),p=o.sp,q=/\?\?\d+/g,r=o.leftSp,s=o.string,t=avalon.config,u={},v=1,y=/=["']/,z=/\n\s*/g,D="(?:\\s+[^>=]*?(?:=[^>]+?)?)*>",E={},F=/./g,G=avalon.msie<9?"ig":"g",K=/&amp;/g,L=/\S+/g,M=/&quot;/g,N=/\s*=\s*/g,P=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;a.exports=B},function(a,b,c){function h(a,b,c){var g,j,k,l;if(a)for(g=0;g<a.length;g++)switch(j=a[g],k=b[g]||e(),j.nodeType){case 3:j.skipContent||f.expr.diff(j,k,c);break;case 8:"for"===j.directive?(l=f["for"].diff(a,b,c,g),"number"==typeof l&&(g=l)):j.directive&&f[j.directive].diff(j,k,c);break;default:j.skipAttrs||i(j,k,c),j.skipContent||h(j.children,k.children||d,c)}}function i(a,b,c){if(a.order)try{a.order.replace(/([^;]+)/g,function(d){var h=d.match(g),i=h&&h[1];return f[i]&&f[i].diff(a,b||e(),c,d),d})}catch(d){avalon.log(a,b,d,"diffProps error")}}var d=[],e=function(){return{children:[],props:{}}},f=avalon.directives,g=c(40).binding;avalon.diffProps=i,a.exports=h},function(a,b,c){function h(a,b){var k,c="string"==typeof a?avalon.vmodels[a]||{}:a;a=c.$id,e[a]?avalon.Array.ensure(f,a):e[a]=!0,"function"==typeof c.$render&&c.$element&&!g&&document.nodeName&&(k=c.$element,j(function(){var b,f,j,l;g=!0,b=c.$render()||[],f={count:0},c.$render.dom&&(j=i(b,c.$id),j&&(k=c.$render.dom,b=[j])),avalon.diff(b,k.vtree||[],f),d([k],b,null,f),f.count=0,k.vtree=b,g=!1,avalon.log("rerender",c.$id,new Date-avalon.rerenderStart),delete e[a];for(l in e){h(l,!0);break}},b))}function i(a,b){var d,c,e;for(c=0;d=a[c++];)if(1===d.nodeType){if(d.props["ms-controller"]===b)return d;if(d.children&&(e=i(d.children,b)))return e}}function j(a,b){if(b){a();var c=f.shift();c&&h(c,!0)}else setTimeout(a,0)}var g,d=c(65),e={},f=[];avalon.suspendUpdate=0,g=!1,a.exports=avalon.batch=h},,function(a){a.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,__proxy__,__data__,__const__")},,,function(a,b,c){function i(a,b){b.__vmodel__=a;var c=d.hideProperty;c(a,"$events",b),c(a,"$watch",function(){if(2===arguments.length)return h.apply(a,arguments);throw"$watch方法参数不对"}),c(a,"$fire",function(b,c,d){var e=a.$events[b];g(e,a,b,c,d)})}function j(a,b,c){return"$"===a.charAt(0)||c[a]||"function"==typeof b||b&&b.nodeName&&b.nodeType>0}function k(a,b,c,f){var g,h;if(Array.isArray(a))return d.arrayFactory(a,b,c,f);if(Object(a)===a&&"function"!=typeof a){if(b&&b.$id){++avalon.suspendUpdate,g=b.$track!==Object.keys(a).sort().join(";;")?d.slaveFactory(b,a,c,f):b;for(h in a)e[h]||(g[h]=a[h]);return--avalon.suspendUpdate,g}return g=d.masterFactory(a,c,f)}return a}function l(a,b,c){function f(){return e}var e=0/0;return f.heirloom=c,{get:f,set:function(h){var i,j,k;e!==h&&(h&&"object"==typeof h&&(h=d.modelAdaptor(h,e,c,{pathname:b,id:a})),i=e,e=h,j=c.__vmodel__,this.$hashcode&&j&&!avalon.suspendUpdate&&(c!==j.$events&&(f.heirloom=j.$events),o(f.$decompose,b,h,i),-1===b.indexOf("*")&&g(f.heirloom[b],j,b,h,i),n(a,j,b,h,i),p(f.heirloom,j,b,h,i),avalon.rerenderStart=new Date,k=j.$id.indexOf("."),k>0?avalon.batch(j.$id.slice(0,k),!0):avalon.batch(j,!0)))},enumerable:!0,configurable:!0}}function n(a,b,c,d,e){var f,h,i;a.indexOf(".*.")>0&&(f=a.match(m),h=avalon.vmodels[f[1]],h&&(i=f[2],g(h.$events[i],b,c,d,e)))}function o(a,b,c,d){var e,f;a&&a[b]&&(e=a[b],e.$hashcode?(f=b.replace(/^[^.]+\./,""),f!==b&&g(e.$events[f],e,f,c,d)):delete a[b])}function p(a,b,c,d,e){a.__fuzzy__&&a.__fuzzy__.replace(avalon.rword,function(f){var h=a[f],i=h.reg;return i&&i.test(c)&&g(h,b,c,d,e),f})}function q(a){var c,b=a.$id;if(!b&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[b])throw Error("error:["+b+"] had defined!");return c=d.masterFactory(a,{},{pathname:"",id:b,master:!0}),avalon.vmodels[b]=c}function r(a,b,c,e){var f,g,h,i,j;if(b&&b.splice)return f=[0,b.length].concat(a),++avalon.suspendUpdate,b.splice.apply(b,f),--avalon.suspendUpdate,b;for(g in s)a[g]=s[g];for(a.notify=function(a,b,d,f){var h,g=c.__vmodel__;g&&(h=null===a||void 0===a?e.pathname:e.pathname+"."+a,g.$fire(h,b,d),f||avalon.suspendUpdate||(avalon.rerenderStart=new Date,avalon.batch(g,!0)))},h=avalon.makeHashCode("$"),e.array=!0,e.hashcode=h,e.id=e.id||h,d.makeObserver(a,c,{},{},e),i=0,j=a.length;j>i;i++)a[i]=k(a[i],0,{},{id:a.$id+".*",master:!0});return a}var m,s,d={},e=c(76),f=c(80),g=f.$emit,h=f.$watch;d.modelAdaptor=k,m=/([^.]+)\.(.+)/,d.arrayFactory=r,s={set:function(a,b){if(a>>>0===a&&this[a]!==b){if(a>this.length)throw Error(a+"set方法的第一个参数不能大于原数组长度");this.splice(a,1,b)}},contains:function(a){return-1!==this.indexOf(a)},ensure:function(a){return this.contains(a)||this.push(a),this},pushArray:function(a){return this.push.apply(this,a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>>>0===a?this.splice(a,1):[]},clear:function(){return this.removeAll(),this}},avalon.define=q,a.exports={$$midway:d,$$skipArray:e,isSkip:j,__array__:s,makeFire:i,makeAccessor:l,modelAdaptor:k}},function(a){function c(a,b){var d,c=b.split(".")[0];try{a.hasOwnProperty(c)&&(d=a.$accessors?a.$accessors[c].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(a,c).get.heirloom.__vmodel__)}catch(e){}return d||a}function d(a){var b=a.split(".");return new RegExp("^"+b.map(function(a){return"*"===a?"(?:[^.]+)":a}).join("\\.")+"$","i")}function e(a,b,c){a&&(b.__fuzzy__?-1===b.__fuzzy__.indexOf(","+c)&&(b.__fuzzy__+=","+c):b.__fuzzy__=c)}function f(a,b){var c=a.indexOf(".*")>0||"*"===a,g=c?this:f.adjust(this,a),h=g.$events,i=h[a]||(h[a]=[]);return c&&(i.reg=i.reg||d(a)),e(c,h,a),g!==this&&(e(c,this.$events,a),this.$events[a]=i),avalon.Array.ensure(i,b),function(){avalon.Array.remove(i,b)}}function g(a,b,c,d,e,f){if(a&&a.length)try{for(f=f||a.length-1;f>=0;f--){var h=a[f];h.call(b,d,e,c)}}catch(i){f-1>0&&g(a,b,c,d,e,f-1),avalon.log(i,c)}}f.adjust=c,a.exports={$emit:g,$watch:f,adjustVm:c}},,,function(a,b,c){var d=c(3),e=c(4);d.shadowCopy(d,e),c(84),c(6),c(7),a.exports=d},function(a){function g(a){if(a&&"object"==typeof a){var b=a.length,d=c.call(a);if(e.test(d))return!0;if("[object Object]"===d&&b===b>>>0)return!0}return!1}var f,c=avalon.inspect,d=/^\[object (?:Window|DOMWindow|global)\]$/,e=/(Array|List|Collection|Map|Arguments)\]$/;avalon.quote=JSON.stringify,f={},"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(a){f["[object "+a+"]"]=a.toLowerCase()}),avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?f[c.call(a)]||"object":typeof a},avalon.isFunction=function(a){return"function"==typeof a},avalon.isWindow=function(a){return d.test(c.call(a))},avalon.isPlainObject=function(a){return"[object Object]"===c.call(a)&&Object.getPrototypeOf(a)===Object.prototype},avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h++),"object"!=typeof g&&"function"!=typeof g&&(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a){c=g[b];try{d=a[b]}catch(k){continue}g!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&avalon.isPlainObject(c)?c:{},g[b]=avalon.mix(j,f,d)):void 0!==d&&(g[b]=d))}return g},avalon.each=function(a,b){var c,d;if(a)if(c=0,g(a))for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},a.exports={avalon:avalon,isArrayLike:g}},function(a,b,c){c(86),c(87),c(88),c(89),c(90),c(91),c(92),c(93),a.exports=avalon},function(){function c(){return(new XMLSerializer).serializeToString(this)}function f(a,b){var c,g,e,h;if(a&&a.childNodes)for(c=a.childNodes,e=0;g=c[e++];)1===g.nodeType?(h=document.createElementNS(d,g.nodeName.toLowerCase()),avalon.each(g.attributes,function(a,b){h.setAttribute(b.name,b.value)}),f(g,h),b.appendChild(h)):b.appendChild(g.cloneNode(!0))}var d,e;avalon.document.contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))}),avalon.contains=function(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(c){return!1}},d="http://www.w3.org/2000/svg",e=avalon.document.createElementNS(d,"svg"),e.innerHTML='<circle fill="red" />',/^\[object SVG\w*Element\]$/.test(e.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{configurable:!0,get:c,set:function(a){var e,b=this.tagName.toLowerCase(),c=this.parent,d=avalon.parseHTML(a);"svg"===b?c.insertBefore(d,this):(e=document.createDocumentFragment(),f(d,e),c.insertBefore(e,this)),c.removeChild(this)}},innerHTML:{configurable:!0,get:function(){var a=this.outerHTML,b=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return a.replace(b,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var b=avalon.parseHTML(a);f(b,this)}}}})},function(){var c=/\S+/g;"add,remove".replace(avalon.rword,function(a){avalon.fn[a+"Class"]=function(b){var d=this[0]||{};return b&&"string"==typeof b&&1===d.nodeType&&b.replace(c,function(b){d.classList[a](b)}),this}}),avalon.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&b.classList.contains(a)},toggleClass:function(a,b){var d="boolean"==typeof b,e=this;return String(a).replace(c,function(a){var c=d?b:!e.hasClass(a);e[c?"addClass":"removeClass"](a)}),this}})},function(){avalon.parseJSON=JSON.parse,avalon.fn.attr=function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)}},function(){function j(a,b){var c,d,e,f;if(a.offsetWidth<=0){if(c=getComputedStyle(a,null),i.test(c["display"])){d={node:a};for(e in h)d[e]=c[e],a.style[e]=h[e];b.push(d)}f=a.parentNode,f&&1===f.nodeType&&j(f,b)}}function k(a){return a.window||a.defaultView||!1}var h,i,c=avalon.root,d=avalon.camelize,e=avalon.cssHooks,f=["","-webkit-","-o-","-moz-","-ms-"],g={"float":"cssFloat"};avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,b,e){if(g[a])return g[a];b=b||c.style;for(var h=0,i=f.length;i>h;h++)if(e=d(f[h]+a),e in b)return g[a]=e;return null},avalon.fn.css=function(a,b){var c,d;if(avalon.isPlainObject(a))for(c in a)avalon.css(this,c,a[c]);else d=avalon.css(this,a,b);return void 0!==d?d:this},avalon.fn.position=function(){var a,b,c=this[0],d={top:0,left:0};return c?("fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=avalon.css(a[0],"borderTopWidth",!0),d.left+=avalon.css(a[0],"borderLeftWidth",!0),d.top-=a.scrollTop(),d.left-=a.scrollLeft()),{top:b.top-d.top-avalon.css(c,"marginTop",!0),left:b.left-d.left-avalon.css(c,"marginLeft",!0)}):d},avalon.fn.offsetParent=function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||c)},e["@:set"]=function(a,b,c){a.style[b]=c},e["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a);
    return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},e["opacity:get"]=function(a){var b=e["@:get"](a,"opacity");return""===b?"1":b},"top,left".replace(avalon.rword,function(a){e[a+":get"]=function(b){var c=e["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}}),h={position:"absolute",visibility:"hidden",display:"block"},i=/^(none|table(?!-c[ea]).+)/,avalon.each({Width:"width",Height:"height"},function(a,b){var c="client"+a,d="scroll"+a,f="offset"+a;e[b+":get"]=function(b,c,d){var g,e=-4;return"number"==typeof d&&(e=d),c="Width"===a?["Left","Right"]:["Top","Bottom"],g=b[f],2===e?g+avalon.css(b,"margin"+c[0],!0)+avalon.css(b,"margin"+c[1],!0):(0>e&&(g=g-avalon.css(b,"border"+c[0]+"Width",!0)-avalon.css(b,"border"+c[1]+"Width",!0)),-4===e&&(g=g-avalon.css(b,"padding"+c[0],!0)-avalon.css(b,"padding"+c[1],!0)),g)},e[b+"&get"]=function(a){var d,g,f,h,c=[];for(j(a,c),d=e[b+":get"](a),f=0;g=c[f++];){a=g.node;for(h in g)"string"==typeof g[h]&&(a.style[h]=g[h])}return d},avalon.fn[b]=function(g){var i,h=this[0];return 0===arguments.length?h.setTimeout?h["inner"+a]:9===h.nodeType?(i=h.documentElement,Math.max(h.body[d],i[d],h.body[f],i[f],i[c])):e[b+"&get"](h):this.css(b,g)},avalon.fn["inner"+a]=function(){return e[b+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return e[b+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var b,c,d,e,a=this[0];try{if(b=a.getBoundingClientRect(),b.width||b.height||a.getClientRects().length)return c=a.ownerDocument,d=c.documentElement,e=c.defaultView,{top:b.top+e.pageYOffset-d.clientTop,left:b.left+e.pageXOffset-d.clientLeft}}catch(f){return{left:0,top:0}}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=k(d),f="scrollTop"===a;return arguments.length?(e?e.scrollTo(f?e[b]:c,f?c:e[b]):d[a]=c,void 0):e?e[b]:d[a]}})},function(){function c(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}var d={"select:get":function e(a,b,c,f){var h,k,j,g=a.children;for(d["option:get"],c=b?c:a.selectedIndex,f=b?f:"select-one"===a.type||0>c,b=b||[],j=0;k=g[j++];)if(!k.disabled)switch(k.nodeName.toLowerCase()){case"option":if(k.selected||k.index===c){if(h=k.value,f)return h;b.push(h)}break;case"optgroup":if(h=e(k,b,c,f),"string"==typeof h)return h}return f?null:b},"select:set":function(a,b,c){b=[].concat(b);for(var e,d=0;e=a.options[d++];)(e.selected=b.indexOf(e.value)>-1)&&(c=!0);c||(a.selectedIndex=-1)}};avalon.fn.val=function(a){var e,f,g,h,b=this[0];if(b&&1===b.nodeType)if(e=0===arguments.length,f=e?":get":":set",g=d[c(b)+f])h=g(b,a);else{if(e)return(b.value||"").replace(/\r/g,"");b.value=a}return e?h:this}},function(a,b,c){var h,i,j,k,l,d=c(26),e=c(27),f=new function(){avalon.shadowCopy(this,{option:document.createElement("select"),thead:document.createElement("table"),td:document.createElement("tr"),area:document.createElement("map"),tr:document.createElement("tbody"),col:document.createElement("colgroup"),legend:document.createElement("fieldset"),_default:document.createElement("div"),g:document.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td},g={g:f.g};String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(avalon.rword,function(a){g[a]=f.g}),h=/<([\w:]+)/,i=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,j=/<|&#?\w+;/,k=new d(128),l=avalon.document.createElement("template"),/HTMLTemplateElement/.test(l)||(l=null,avalon.shadowCopy(f,g)),avalon.parseHTML=function(a){var c,d,m,n,b=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof a)return b;if(!j.test(a))return b.appendChild(document.createTextNode(a)),b;if(a=a.replace(i,"<$1></$2>").trim(),d=k.get(a))return d.cloneNode(!0);if(m=(h.exec(a)||["",""])[1].toLowerCase(),n=g[m],n?n.innerHTML=a:l?(l.innerHTML=a,n=l.content):(n=f[m]||f._default,n.innerHTML=a),e(n),l)b=n;else for(;c=n.firstChild;)b.appendChild(c);return a.length<1024&&k.put(a,b.cloneNode(!0)),b},avalon.innerHTML=function(a,b){var c=this.parseHTML(b);this.clearHTML(a).appendChild(c)},avalon.clearHTML=function(a){for(avalon.$$unbind(a),a.textContent="";a.lastChild;)a.removeChild(a.lastChild);return a}},function(a,b,c){function m(a,b,c){var e,f,d=a.getAttribute("avalon-events");!d||a.disabled===!0&&"click"===b||(e=[],f=l[b]||(l[b]=new RegExp(b+"\\:([^?s]+)","g")),d.replace(f,function(a,b){return e.push(b),a}),e.length&&c.push({elem:a,uuids:e})),a=a.parentNode,a&&a.getAttribute&&h[b]&&m(a,b,c)}function p(a){var b,c,d,f,g,h,e,i,j,l,p;for(a=new v(a),b=a.type,c=a.target,d=[],m(c,b,d),e=0;(h=d[e++])&&!a.cancelBubble;)for(a.currentTarget=h.elem,f=0;(g=h.uuids[f++])&&!a.isImmediatePropagationStopped;)if(i=avalon.eventListeners[g]){if(j=n.test(g)?h.elem._ms_context_:0,j&&j.$hashcode===!1)return avalon.unbind(c,b,i);o.test(b)?(l=+new Date,l-k>16&&(p=i.call(j||c,a),k=l)):p=i.call(j||c,a),p===!1&&(a.preventDefault(),a.stopPropagation())}}function t(a){var c,b=f.getAttribute("delegate-events")||"";-1===b.indexOf(a)&&(c=b.match(j)||[],c.push(a),f.setAttribute("delegate-events",c.join("??")),r(f,a,p,!!q[a]))}function v(a){if(a.originalEvent)return this;for(var b in a)u.test(b)||"function"==typeof a[b]||(this[b]=a[b]);this.timeStamp=new Date-0,this.originalEvent=a}var j,k,l,n,o,q,r,s,u,d=avalon.document,e=avalon.window,f=avalon.root,g=c(6).getShortID,h=c(32),i=avalon.eventHooks;avalon.bind=function(a,b,c){var d,e,f,j,k;return 1===a.nodeType?(d=a.getAttribute("avalon-events")||"",e=g(c),f=b+":"+e,j=i[b],j&&(b=j.type,j.fix&&(c=j.fix(a,c),c.uuid=e+"0"),f=b+":"+c.uuid),avalon.eventListeners[c.uuid]=c,-1===d.indexOf(b+":")&&(h[b]||q[b]?t(b):r(a,b,p)),k=d.split("??"),""===k[0]&&k.shift(),-1===k.indexOf(f)&&(k.push(f),a.setAttribute("avalon-events",k.join("??")))):r(a,b,c),c},avalon.unbind=function(a,b,c){var d,e;if(1===a.nodeType)switch(d=a.getAttribute("avalon-events")||"",arguments.length){case 1:s(a,b,p),a.removeAttribute("avalon-events");break;case 2:d=d.split("??").filter(function(a){return-1===a.indexOf(b+":")}).join("??"),a.setAttribute("avalon-events",d);break;default:e=b+":"+c.uuid,d=d.split("??").filter(function(a){return a!==e}).join("??"),a.setAttribute("avalon-events",d),delete avalon.eventListeners[c.uuid]}else s(a,b,c)},j=/[^\s\?]+/g,k=Date.now(),l={},n=/^e\d+/,o=/move|scroll/,q={focus:!0,blur:!0},r=function(a,b,c,d){a.addEventListener(b,c,d)},s=function(a,b,c){a.removeEventListener(b,c)},u=/^(?:ms|webkit|moz)/,v.prototype={preventDefault:function(){var a=this.originalEvent;this.returnValue=!1,a&&(a.returnValue=!1,a.preventDefault())},stopPropagation:function(){var a=this.originalEvent;this.cancelBubble=!0,a&&(a.cancelBubble=!0,a.stopPropagation())},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=!0,a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},avalon.fireDom=function(a,b,c){var e=d.createEvent("Events");e.initEvent(b,!0,!0),avalon.shadowCopy(e,c),a.dispatchEvent(e)},i=avalon.eventHooks,"onmouseenter"in f||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){i[a]={type:b,fn:function(b,c){return function(d){var e=d.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete d.type,d.type=a,c.call(this,d))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(a,b){e[a]&&!i.animationend&&(i.animationend={type:b})}),void 0===d.onmousewheel&&(i.mousewheel={type:"wheel",fn:function(a,b){return function(a){a.wheelDeltaY=a.wheelDelta=a.deltaY>0?-120:120,a.wheelDeltaX=0,Object.defineProperty(a,"type",{value:"mousewheel"}),b.call(this,a)}}}),avalon.fn.bind=function(a,b,c){return this[0]?avalon.bind(this[0],a,b,c):void 0},avalon.fn.unbind=function(a,b,c){return this[0]&&avalon.unbind(this[0],a,b,c),this},avalon.$$unbind=function(a){var b=a.querySelectorAll("[avalon-events]");avalon.each(b,function(a,b){avalon.unbind(b)})}},function(a,b,c){var h,d=c(34),e=avalon.document,f=avalon.window,g=[],i=function(a){for(h=!0;a=g.shift();)a(avalon)};"complete"===e.readyState?setTimeout(i):e.addEventListener("DOMContentLoaded",i),avalon.bind(f,"load",i),avalon.ready=function(a){h?a(avalon):g.push(a)},avalon.ready(function(){d(e.body)})},function(a,b,c){c(36),c(44),c(95),c(48),c(49),c(97),c(51),c(52),c(53),c(54),c(98),c(62),c(63),c(64),c(66),c(101),c(69)},function(a,b,c){var d=c(96),e=c(43);avalon.directive("attr",{parse:function(a,b){return"vnode"+b+'.props["ms-attr"] = '+avalon.parseExpr(a)+";\n"},diff:function(a,b,c,f){var i,j,k,g=a.props[f],h=b.props[f];if(Object(g)===g){if(Array.isArray(g)&&(g=a.props[f]=avalon.mix.apply({},g)),"object"!=typeof h)a.changeAttr=g;else{i={},j=!1;for(k in g)g[k]!==h[k]&&(j=!0,i[k]=g[k]);j&&(a.changeAttr=i,c.count+=1)}a.changeAttr&&e(a,d,c,"attr")}else a.props[f]=h},update:d})},function(a,b,c){function f(a,b){var f,g,h,i,j,k,c=b.changeAttr;if(c)for(f in c)if(g=c[f],"src"===f&&window.chrome&&"EMBED"===a.tagName)a[f]=g,h=a.parentNode,i=document.createComment("ms-src"),h.replaceChild(i,a),h.replaceChild(a,i);else if(0==f.indexOf("data-"))a.setAttribute(f,g);else{if(j=d[f]||f,"boolean"==typeof a[j]&&(a[j]=!!g),g===!1){a.removeAttribute(f);continue}k=e.test(a)?!1:f in a.cloneNode(!1),k?a[j]=g+"":a.setAttribute(f,g)}b.changeAttr=null}var d=c(47),e=/^\[object SVG\w*Element\]$/;a.exports=f},function(a,b,c){var d=c(43);avalon.directive("expr",{parse:function(){},diff:function(a,b,c){a.nodeValue!==b.nodeValue&&d(a,this.update,c,"expr")},update:function(a,b,c){if(3!==a.nodeType){var d=document.createTextNode(b.nodeValue);c.replaceChild(d,a)}else a.nodeValue=b.nodeValue}})},function(a,b,c){function k(a,b){var d,e,f,h,g,i,c=[];for(a.children.forEach(function(a){"option"===a.type?c.push(a):"optgroup"===a.type&&a.children.forEach(function(a){"option"===a.type&&c.push(a)})}),d=a.props.multiple,e={},f=null===d||void 0===d||d===!1,Array.isArray(b)?b.forEach(function(a){e[a]=1}):e[b]=1,g=0;(h=c[g++])&&(i="value"in h.props?h.props.value:(h.children[0]||{nodeValue:""}).nodeValue.trim(),h.props.selected=!!e[i],!e[i]||!f););}var d=c(56),e=c(57),f=c(99),g=c(100),h=c(61),i=c(43),j=c(39);avalon.directive("duplex",{priority:2e3,parse:function(a,b,c){var f,g,d=a.expr;return e(a,c),avalon.caches[d]=c.field,f="vnode"+b+".duplexVm = __vmodel__;\n"+"vnode"+b+'.props["ms-duplex"] = '+avalon.quote(d)+";\n"+"vnode"+b+'.props["data-duplex-get"] = '+j.get("duplex:"+d)+"\n"+"vnode"+b+'.props["data-duplex-set"] = '+j.get("duplex:set:"+d)+"\n",g=j.get("duplex:format:"+d),g&&(f+="vnode"+b+'.props["data-duplex-format"] = '+g),f},diff:function(a,b,c){var e,g,h,j,d=a.props["ms-duplex"];a.field=b.field||avalon.mix({},avalon.caches[d]),e=a.field,e.set||f(a),a.duplexVm=null,g=a.props.value=e.get(e.vmodel),"select"!==a.type||a.children.length||(avalon.Array.merge(a.children,avalon.lexer(a.template,0,2)),k(a,g)),e.element?(j=b.props.value,h=Array.isArray(g)?g+""==j+"":g===j):h=!1,h||(e.modelValue=g,i(a,this.update,c,"duplex","afterChange"))},update:function(a,b){var e,f,i,j,k,c=a._ms_field_=b.field;if(!c.element){c.element=a,e=c.events;for(f in e)avalon.bind(a,f,e[f]),delete e[f]}h(a,b),avalon.msie||d!==!1||a.valueHijack||(a.valueHijack=c.update,i=setInterval(function(){avalon.contains(avalon.root,a)?a.valueHijack():clearInterval(i)},30)),j=c.format(c.modelValue),c.viewValue!==j&&(c.viewValue=j,g[c.type].call(c),a.caret&&(k=c.caretPos,k&&c.updateCaret(a,k.start,k.end),c.caretPos=null))}})},function(a,b,c){function g(a){var c,e,b=a.field;switch(b.update=h,b.updateCaret=n,b.get=a.props["data-duplex-get"],b.set=a.props["data-duplex-set"],c=a.props["data-duplex-format"],c&&b.formatters.push(function(a){return c(b.vmodel,a)}),b.vmodel=a.duplexVm,e=b.events={},b.type){case"radio":"radio"===a.props.type?e.click=h:e.change=h;break;case"checkbox":case"select":e.change=h;break;case"contenteditable":b.isChanged?e.blur=h:(d.webkitURL?e.webkitEditableContentChanged=h:d.MutationEvent&&(e.DOMCharacterDataModified=h),e.input=h);break;case"input":b.isChanged?e.change=h:(e.input=h,avalon.msie||(e.compositionstart=k,e.compositionend=l))}/password|text/.test(a.props.type)&&(e.focus=i,e.blur=j)}function h(){var c,f,g,a=this,b=this._ms_field_;if(!a.composing&&a.value!==b.lastViewValue){if(a.caret)try{c=m(a),(c.start===c.end||c.start+1===c.end)&&(b.caretPos=c)}catch(d){avalon.warn("fixCaret error",d)}b.debounceTime>4?(f=new Date,g=f-b.time||0,b.time=f,g>=b.debounceTime?e[b.type].call(b):(clearTimeout(b.debounceID),b.debounceID=setTimeout(function(){e[b.type].call(b)},g))):e[b.type].call(b)}}function i(){this.caret=!0}function j(){this.caret=!1}function k(){this.composing=!0}function l(a){this.composing=!1,h.call(this,a)}function m(a){var b=0/0,c=0/0;return a.setSelectionRange&&(b=a.selectionStart,c=a.selectionEnd),{start:b,end:c}}function n(a,b,c){a.value&&!a.readOnly&&(a.selectionStart=b,a.selectionEnd=c)}var d=avalon.window,e=c(59),f=c(6).getShortID;f(i),f(j),f(k),f(l),f(h),a.exports=g},function(a){var c={input:function(){this.element.value=this.viewValue},radio:function(){var a;a=this.isChecked?!!this.viewValue:this.viewValue+""===this.element.value,this.element.checked=a},checkbox:function(){var d,e,a=!1,b=this.element,c=b.value;for(d=0;d<this.modelValue.length;d++)e=this.modelValue[d],e+""===c&&(a=!0);b.checked=a},select:function(){var a=Array.isArray(this.viewValue)?this.viewValue.map(String):this.viewValue+"";avalon(this.element).val(a)},contenteditable:function(){this.element.innerHTML=this.viewValue,this.update.call(this.element)}};a.exports=c},function(a,b,c){var d=c(102),e=c(65),f=c(43),g=avalon.directive("widget",{priority:4,parse:function(a,b,c){var e,f,d=!!c.isVoidTag;return c.isVoidTag=!0,e=c.props.wid||(c.props.wid=avalon.makeHashCode("w")),avalon.resolvedComponents[e]={props:avalon.shadowCopy({},c.props),template:c.template},f=["vnode"+b+"._isVoidTag = "+d,"vnode"+b+'.props.wid = "'+e+'"',"vnode"+b+".template = "+avalon.quote(c.template),"vnode"+b+'.props["ms-widget"] = '+avalon.parseExpr(a,"widget"),"vnode"+b+" = avalon.component(vnode"+b+", __vmodel__)","if(typeof vnode"+b+'.render === "string"){',"avalon.__widget = [];","var __backup__ = __vmodel__;","__vmodel__ = vnode"+b+".vmodel;",'try{eval(" new function(){"+ vnode'+b+'.render +"}");',"}catch(e){avalon.warn(e)","}","vnode"+b+" = avalon.renderComponent(avalon.__widget[0])","}","__vmodel__ = __backup__;"],f.join("\n")+"\n"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(a,b,c){function h(b,c){a.vmodel.$fire("onReady",{type:"ready",target:b,wid:e,vmodel:c.vmodel}),g.renderCount=2}var i,j,d=avalon.resolvedComponents,e=a.props.wid,g=d[e];g&&g.renderCount?g.renderCount&&g.renderCount<2?(a.steps=c,b.children=[],f(a,this.replaceByComponent,c,"widget"),f(a,h,c,"widget","afterChange")):(i=!a.diff||a.diff(a,b,c),a.skipContent=!i,j=a.vmodel.$events.onViewChange,j&&j.length&&(c.count+=1,a.afterChange=[function(c,d){var f=b.outerHTML,h=a.outerHTML||(a.outerHTML=avalon.vdomAdaptor(a,"toHTML"));f!==h&&a.vmodel.$fire("onViewChange",{type:"viewchange",target:c,wid:e,vmodel:d.vmodel}),g.renderCount++}])):(c.count+=1,a.change=[this.replaceByComment])},addDisposeMonitor:function(a){d.byRewritePrototype(a)},replaceByComment:function(a,b,c){var d=document.createComment(b.nodeValue);a?c.replaceChild(d,a):c.appendChild(d)},replaceByComponent:function(a,b,c){var d=avalon.vdomAdaptor(b,"toDOM");return b.ouerHTML=avalon.vdomAdaptor(b,"toHTML"),a?c.replaceChild(d,a):c.appendChild(d),e([d],[b],c,b.steps),g.addDisposeMonitor(d),!1}})},function(a){function c(){function b(b,c){var d=a[b];a[b]=function(a,b){return c.call(this,d,a,b)}}if(!c.execute){c.execute=!0;var a=Node.prototype;b("removeChild",function(a,b,c){return a.call(this,b,c),1===b.nodeType&&e(b),b}),b("replaceChild",function(a,b,c){return a.call(this,b,c),1===b.nodeType&&e(b),b}),b("innerHTML",function(a,b){var c=this.getElementsByTagName("*");a.call(this,b),f(c)}),b("appendChild",function(a,b){return a.call(this,b),1===b.nodeType&&11===this.nodeType&&e(b),b}),b("insertBefore",function(a,b){return a.call(this,b),1===b.nodeType&&11===this.nodeType&&e(b),b})}}function d(a){var b,c,d,e;return 1===a.nodeType&&a.getAttribute("wid")&&!avalon.contains(avalon.root,a)?(b=a.getAttribute("wid"),c=avalon.resolvedComponents[b],d=c.vmodel,e=!!c.cached,c.vmodel.$fire("onDispose",{type:"dispose",target:a,vmodel:d,cached:e}),c&&c.vmodel&&!e&&(d.$element=null,d.$hashcode=!1,delete c.vmodel,delete avalon.resolvedComponents[b]),!1):void 0}function e(a){setTimeout(function(){d(a)},4)}function f(a){for(var c,b=0;c=a[b++];)d(c)}a.exports={byRewritePrototype:c}},function(a,b,c){function k(a){return a.length>3&&a.indexOf("-")>0&&j.test(a.charAt(0)+a.slice(-1))}function l(a,b,c){var d,e;for(d in b)b.hasOwnProperty(d)&&(e=b[d],h[d]?d in a?a[d].push(e):a[d]=[b[d]]:isFinite(c)&&(a[d]=e))}function m(a){var b=!0;try{n(a)}catch(c){b=!1}return b}function n(a){a.children.forEach(function(a){if(8===a.nodeType&&a.props){if("ms-widget"in a.props)throw"unresolved"}else a.children&&n(a)})}function o(a,b,c){var d={};c?d[c]=b.children:b.children.forEach(function(a){if(1===a.nodeType){var b=a.props.slot||"default";d[b]?d[b].push(a):d[b]=[a]}}),p(a,d)}function p(a,b){var d,c,e,f;for(c=0;d=a[c++];)1===d.nodeType&&("slot"===d.type?(e=d.props.name||"default",b[e]&&(f=b[e],a.splice.apply(a,[c-1,1].concat(f)),1===f.length&&3===f[0].nodeType&&q(a))):p(d.children,b));return a}function q(a){var c,b,d,e;for(b=0;c=a[b];b++)c.skipContent===!1&&3===c.nodeType&&(d=a[b-1],e=a[b+1],d&&3===d.nodeType&&!/\S/.test(d.nodeValue)&&(avalon.Array.remove(a,d),--b),e&&3===e.nodeType&&!/\S/.test(e.nodeValue)&&avalon.Array.remove(a,e))}var j,d=c(16),e=c(37),f=avalon.resolvedComponents,g={wbr:1,xmp:1,template:1},h=avalon.oneObject("onInit,onReady,onViewChange,onDispose"),i=avalon.mix({is:1,diff:1,define:1,cached:1},h);avalon.document.createElement("slot"),avalon.component=function(a,b){var c,j,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;if("string"!=typeof a){if(c=a,j=b,m=c.props.wid,n={},q=c.props["ms-widget"]||{},q=Array.isArray(q)?q:[q],q.forEach(function(a,b){l(n,a,b)}),n.cached&&(r=avalon.vmodels[n.$id],r&&(s=r.$events.__wid__,delete f[m],m=s)),t=f[m],t||(f[m]=c,t=c),t.render)return t;if(u=c.type.indexOf("-")>0?c.type:n.is,v={nodeType:8,type:"#comment",directive:"widget",props:{"ms-widget":m},nodeValue:"ms-widget placeholder"},avalon.components[u]){w=c.type,g[w]||k(w)||avalon.warn(w+"不合适做组件的标签"),("xmp"===w||"template"===w||0===c.children.length)&&(c.children=avalon.lexer(t.template)),b=avalon.components[u],x=n.diff,y=n.define,y=y||avalon.directives.widget.define,z=n.$id||avalon.makeHashCode(u.replace(/-/g,"_")),A=avalon.mix(!0,{},b.defaults),l(n,A,!1),B=[j,A].concat(q),C=y.apply(function(a,b){for(var c in i)delete a[c],delete b[c]},B),C.$id=z,C.$element=j.$element,avalon.vmodels[z]=C,D=b.template.trim(),"function"==typeof b.getTemplate&&(D=b.getTemplate(C,D)),E=avalon.lexer(D),E.length>1&&avalon.error("组件必须用一个元素包起来"),F=E[0];for(G in t.props)"ms-widget"!==G&&(F.props[G]=t.props[G]);b.soleSlot?(H={},I=b.soleSlot,H[I]=/\S/.test(t.template)?c.children:new d("{{@"+I+"}}"),p(E,H)):c.isVoidTag||o(E,c,b.soleSlot);for(G in h)n[G]&&n[G].forEach(function(a){C.$watch(G,a)});return J=J||String(new Date-0).slice(0,6),K=e(E,J)+"\nreturn (avalon.__widget = vnodes"+J+");\n",C.$render=j.$render,C.$events.__wid__=m,C.$fire("onInit",{type:"init",vmodel:C,wid:m,target:null}),avalon.shadowCopy(t,{diff:x,render:K,vmodel:C,cached:!!n.cached,placeholder:v}),t}return v}avalon.components[a]||(avalon.components[a]=b)},j=/^[a-z]+$/,avalon.renderComponent=function(a){var b=avalon.resolvedComponents[a.props.wid],c=a.order;return a.order=c?"ms-widget;;"+c:"ms-widget",m(a)?(b.renderCount||(b.renderCount=1),a.props["ms-widget"]=b.props["ms-widget"],a.vmodel=b.vmodel,a.diff=b.diff,delete a.skipAttrs,a):b.placeholder}},function(a,b,c){function m(){}function n(a,b,c){var f,k,n,o,p,q,r,s,t,d={};a.$skipArray&&(d=avalon.oneObject(a.$skipArray),delete a.$skipArray),f={},c=c||{},b=b||{},k={},n=l("$"),o=c.pathname||"",c.id=c.id||n,c.hashcode=n;for(p in a)g[p]||(s=f[p]=a[p],e(p,s,d)||(q=c.id+"."+p,r=o?o+"."+p:p,k[p]=h(q,r,b)));k.$model=j,t=new m,Object.defineProperties(t,k);for(p in f)t[p]=f[p],p in d?delete f[p]:f[p]=!0;return i(t,b,f,k,c),t}function p(a,b,c,d){var n,p,q,r,s,f={},k={},m=d.pathname;c=c||{};for(n in b)g[n]||(f[n]=b[n],e(n,b[n],o)||(r=Object.getOwnPropertyDescriptor(a,n),r&&r.get?k[n]=r:(p=d.id+"."+n,q=m?m+"."+n:n,k[n]=h(p,q,c))));for(n in a)delete a[n];d.hashcode=a.$hashcode||l("$"),k.$model=j,s=a,Object.defineProperties(s,k);for(n in f)k[n]||(s[n]=f[n]),f[n]=!0;return i(s,c,f,k,d),s}function q(a){var o,p,q,r,s,t,u,v,c={},d={},f={},j={},k={},n=avalon.slice(arguments);for(q=0;q<n.length;q++){r=n[q];for(s in r)c[s]=r[s],"$skipArray"===s&&Array.isArray(r.$skipArray)&&r.$skipArray.forEach(function(a){k[a]=1}),t=Object.getOwnPropertyDescriptor(r,s),t.set?-1===n.indexOf(r[s])?d[s]=t:(o=c[s],p=s,delete c[s]):"function"!=typeof c[s]&&(f[s]=1)}"function"==typeof this&&this(c,f);for(s in f)g[s]||d[s]||e(s,c[s],k)||(d[s]=h(a.$id+"."+s,s,j),d[s].set(c[s]));u=new m,Object.defineProperties(u,d);for(s in c)d[s]||(u[s]=c[s]),p&&d[s]&&o.hasOwnProperty(s)&&(v=d[s],v.get.$decompose||(v.get.$decompose={}),v.get.$decompose[p+"."+s]=u),c[s]=!0;return i(u,j,c,d,{id:a.$id,hashcode:l("$"),master:!0}),u}function u(a,b){a.length!==b&&a.notify("length",a.length,b,!0)}var h,i,j,k,l,o,r,s,t,v,d=c(105),e=d.isSkip,f=d.$$midway,g=d.$$skipArray;delete g.$accessors,delete g.__data__,delete g.__proxy__,delete g.__const__,h=d.makeAccessor,i=d.makeObserver,j=d.modelAccessor,k=d.modelAdaptor,l=avalon.makeHashCode,f.masterFactory=n,o={},f.slaveFactory=p,f.mediatorFactory=avalon.mediatorFactory=q,r=d.__array__,s=Array.prototype,t=s.splice,r.removeAll=function(a){var c,d,b=this.length;if(Array.isArray(a))for(c=this.length-1;c>=0;c--)-1!==a.indexOf(this[c])&&t.call(this,c,1);else if("function"==typeof a)for(c=this.length-1;c>=0;c--)d=this[c],a(d,c)&&t.call(this,c,1);else t.call(this,0,this.length);u(this,b),this.notify()},v=["push","pop","shift","unshift","splice"],v.forEach(function(a){var b=s[a];r[a]=function(c,d){var g,h,i,j,l,m,n,o,e=[],f=this.length;if("splice"===a&&Object(this[0])===this[0])for(g=this.slice(c,d),h=s.slice.call(arguments,2),e=[c,d],i=0,j=h.length;j>i;i++)l=g[i],e[i+2]=k(h[i],l,l&&l.$events,{id:this.$id+".*",master:!0});else for(m=0,n=arguments.length;n>m;m++)e[m]=k(arguments[m],0,{},{id:this.$id+".*",master:!0});return o=b.apply(this,e),u(this,f),this.notify(),o}}),"sort,reverse".replace(avalon.rword,function(a){r[a]=function(){return s[a].apply(this,arguments),this.notify(),this}}),a.exports=avalon},function(a,b,c){function f(a){var c,d,e,g,b=avalon.type(a);if("array"===b){for(c=[],d=0;d<a.length;d++)c[d]=f(a[d]);return c}if("object"===b){e={};for(d in a)a.hasOwnProperty(d)&&(g=a[d],e[d]=g&&g.nodeType?g:f(g));return e}return a}function g(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0})}function i(a,b,c,d,f){function i(a){return c[a]===!0}f.array?Object.defineProperty(a,"$model",h):g(a,"hasOwnProperty",i),g(a,"$id",f.id),g(a,"$hashcode",f.hashcode),g(a,"$track",Object.keys(c).sort().join(";;")),f.master===!0&&(g(a,"$element",null),g(a,"$render",0),e(a,b))}var j,k,d=c(79),e=d.makeFire,h={get:function(){return f(this)},set:avalon.noop,enumerable:!1,configurable:!0};d.$$midway.hideProperty=g,d.$$midway.makeObserver=i,j={toJson:f,makeObserver:i,modelAccessor:h};for(k in d)j[k]=d[k];a.exports=j}])});